import { Method, Parameterlist, Attribute } from "../compiler/types/Types.js";
import { Klass, Visibility } from "../compiler/types/Class.js";
import { stringPrimitiveType, intPrimitiveType } from "../compiler/types/PrimitiveTypes.js";
import { RuntimeObject } from "../interpreter/RuntimeObject.js";
export class SystemClass extends Klass {
    constructor(module) {
        super("System", module, "Klasse mit statischen Methoden für Systemfunktionen, z.B. Sound, Löschen der Ausgabe usw.");
        this.deltaTimeMillis = 0; // when using WebSocket then the Server sends time synchronization
        this.printStream = new RuntimeObject(module.typeStore.getType("PrintStream"));
        this.setBaseClass(module.typeStore.getType("Object"));
        this.addAttribute(new Attribute("out", module.typeStore.getType("PrintStream"), (value) => { value.value = this.printStream; }, true, Visibility.public, true, "PrintStream-Objekt, mit dem Text ausgegeben werden kann."));
        this.staticClass.setupAttributeIndicesRecursive();
        this.staticClass.classObject = new RuntimeObject(this.staticClass);
        // this.addMethod(new Method("clearScreen", new Parameterlist([
        // ]), null,
        //     (parameters) => {
        //         module.main.getInterpreter().printManager.clear();
        //     }, false, true, "Löscht den Bildschirm"));
        // this.addMethod(new Method("addKeyListener", new Parameterlist([
        //     { identifier: "keyListener", type: module.typeStore.getType("KeyListener"), declaration: null, usagePositions: null, isFinal: true }
        // ]), null,
        // (parameters) => {
        //     let r: RuntimeObject = parameters[1].value;
        //     let method = (<Klass>r.class).getMethodBySignature("onKeyTyped(String)");
        //     if (method != null) {
        //         module.main.getInterpreter().keyboardTool.keyPressedCallbacks.push((key) => {
        //             let program = method?.program;
        //             let invoke = method?.invoke;
        //             let stackElements: Value[] = [
        //                 {
        //                     type: r.class,
        //                     value: r
        //                 },
        //                 {
        //                     type: stringPrimitiveType,
        //                     value: key
        //                 }
        //             ];
        //             if (program != null) {
        //                 module.main.getInterpreter().runTimer(method, stackElements, null, false);
        //             } else if (invoke != null) {
        //                 invoke([]);
        //             }
        //         });
        //     }
        // }    
        // , false, true, "Fügt einen KeyListener hinzu, dessen Methode keyTyped immer dann aufgerufen wird, wenn eine Taste gedrückt und anschließend losgelassen wird."));
        // this.addMethod(new Method("playSound", new Parameterlist([
        //     { identifier: "sound", type: stringPrimitiveType, declaration: null, usagePositions: null, isFinal: true }
        // ]), null,
        // (parameters) => {
        //     let sound: string = parameters[1].value;
        //     SoundTools.play(sound);
        // }    
        // , false, true, "Spielt einen Sound ab. Die Möglichen Sounds sind als statische Variablen der Klasse Sound hinterlegt. Tippe als Parameter also Sound gefolgt von einem Punkt ein, um eine Auswahl zu sehen!"));
        this.addMethod(new Method("currentTimeMillis", new Parameterlist([]), intPrimitiveType, (parameters) => {
            return Date.now() + this.deltaTimeMillis;
        }, false, true, "Gibt die Anzahl der Millisekunden, die seit dem 01.01.1970 00:00:00 UTC vergangen sind, zurück."));
    }
}
export class PrintStreamClass extends Klass {
    constructor(module) {
        super("PrintStream", module, "Interne Hilfsklasse, um System.out.println zu ermöglichen. Das Objekt System.out ist von der Klasse PrintStream.");
        this.setBaseClass(module.typeStore.getType("Object"));
        this.addMethod(new Method("print", new Parameterlist([
            { identifier: "text", type: stringPrimitiveType, declaration: null, usagePositions: null, isFinal: true }
        ]), null, (parameters) => {
            module.main.getInterpreter().printManager.print(parameters[1].value);
        }, false, true, "Gibt den Text aus."));
        this.addMethod(new Method("println", new Parameterlist([
            { identifier: "text", type: stringPrimitiveType, declaration: null, usagePositions: null, isFinal: true }
        ]), null, (parameters) => {
            module.main.getInterpreter().printManager.println(parameters[1].value);
        }, false, true, "Gibt den Text aus, gefolgt von einem Zeilensprung."));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3lzdGVtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NsaWVudC9ydW50aW1lbGlicmFyeS9TeXN0ZW0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFRLE1BQU0sRUFBRSxhQUFhLEVBQVMsU0FBUyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDM0YsT0FBTyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQWEsTUFBTSw0QkFBNEIsQ0FBQztBQUMxRSxPQUFPLEVBQUUsbUJBQW1CLEVBQTJDLGdCQUFnQixFQUFxQixNQUFNLHFDQUFxQyxDQUFDO0FBR3hKLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUloRSxNQUFNLE9BQU8sV0FBWSxTQUFRLEtBQUs7SUFNbEMsWUFBWSxNQUFjO1FBQ3RCLEtBQUssQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLDJGQUEyRixDQUFDLENBQUM7UUFIekgsb0JBQWUsR0FBVyxDQUFDLENBQUMsQ0FBQyxrRUFBa0U7UUFLM0YsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLGFBQWEsQ0FBUSxNQUFNLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO1FBRXJGLElBQUksQ0FBQyxZQUFZLENBQVEsTUFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUU3RCxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksU0FBUyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsRUFDMUUsQ0FBQyxLQUFLLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsVUFBVSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsMERBQTBELENBQUMsQ0FBQyxDQUFDO1FBRS9J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LEVBQUUsb0RBQW9ELENBQUMsQ0FBQyxDQUFDO0lBRy9FLENBQUM7Q0FFSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR5cGUsIE1ldGhvZCwgUGFyYW1ldGVybGlzdCwgVmFsdWUsIEF0dHJpYnV0ZSB9IGZyb20gXCIuLi9jb21waWxlci90eXBlcy9UeXBlcy5qc1wiO1xyXG5pbXBvcnQgeyBLbGFzcywgVmlzaWJpbGl0eSwgSW50ZXJmYWNlIH0gZnJvbSBcIi4uL2NvbXBpbGVyL3R5cGVzL0NsYXNzLmpzXCI7XHJcbmltcG9ydCB7IHN0cmluZ1ByaW1pdGl2ZVR5cGUsIGRvdWJsZVByaW1pdGl2ZVR5cGUsIGZsb2F0UHJpbWl0aXZlVHlwZSwgaW50UHJpbWl0aXZlVHlwZSwgdm9pZFByaW1pdGl2ZVR5cGUgfSBmcm9tIFwiLi4vY29tcGlsZXIvdHlwZXMvUHJpbWl0aXZlVHlwZXMuanNcIjtcclxuaW1wb3J0IHsgTW9kdWxlIH0gZnJvbSBcIi4uL2NvbXBpbGVyL3BhcnNlci9Nb2R1bGUuanNcIjtcclxuaW1wb3J0IHsgUHJpbnRNYW5hZ2VyIH0gZnJvbSBcIi4uL21haW4vZ3VpL1ByaW50TWFuYWdlci5qc1wiO1xyXG5pbXBvcnQgeyBSdW50aW1lT2JqZWN0IH0gZnJvbSBcIi4uL2ludGVycHJldGVyL1J1bnRpbWVPYmplY3QuanNcIjtcclxuaW1wb3J0IHsgRW51bVJ1bnRpbWVPYmplY3QgfSBmcm9tIFwiLi4vY29tcGlsZXIvdHlwZXMvRW51bS5qc1wiO1xyXG5pbXBvcnQgeyBTb3VuZFRvb2xzIH0gZnJvbSBcIi4uL3Rvb2xzL1NvdW5kVG9vbHMuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTeXN0ZW1DbGFzcyBleHRlbmRzIEtsYXNzIHtcclxuXHJcbiAgICBwcmludFN0cmVhbTogUnVudGltZU9iamVjdDtcclxuXHJcbiAgICBkZWx0YVRpbWVNaWxsaXM6IG51bWJlciA9IDA7IC8vIHdoZW4gdXNpbmcgV2ViU29ja2V0IHRoZW4gdGhlIFNlcnZlciBzZW5kcyB0aW1lIHN5bmNocm9uaXphdGlvblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1vZHVsZTogTW9kdWxlKSB7XHJcbiAgICAgICAgc3VwZXIoXCJTeXN0ZW1cIiwgbW9kdWxlLCBcIktsYXNzZSBtaXQgc3RhdGlzY2hlbiBNZXRob2RlbiBmw7xyIFN5c3RlbWZ1bmt0aW9uZW4sIHouQi4gU291bmQsIEzDtnNjaGVuIGRlciBBdXNnYWJlIHVzdy5cIik7XHJcblxyXG4gICAgICAgIHRoaXMucHJpbnRTdHJlYW0gPSBuZXcgUnVudGltZU9iamVjdCg8S2xhc3M+bW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiUHJpbnRTdHJlYW1cIikpO1xyXG5cclxuICAgICAgICB0aGlzLnNldEJhc2VDbGFzcyg8S2xhc3M+bW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiT2JqZWN0XCIpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRBdHRyaWJ1dGUobmV3IEF0dHJpYnV0ZShcIm91dFwiLCBtb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJQcmludFN0cmVhbVwiKSxcclxuICAgICAgICAgICAgKHZhbHVlKSA9PiB7IHZhbHVlLnZhbHVlID0gdGhpcy5wcmludFN0cmVhbSB9LCB0cnVlLCBWaXNpYmlsaXR5LnB1YmxpYywgdHJ1ZSwgXCJQcmludFN0cmVhbS1PYmpla3QsIG1pdCBkZW0gVGV4dCBhdXNnZWdlYmVuIHdlcmRlbiBrYW5uLlwiKSk7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhdGljQ2xhc3Muc2V0dXBBdHRyaWJ1dGVJbmRpY2VzUmVjdXJzaXZlKCk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLnN0YXRpY0NsYXNzLmNsYXNzT2JqZWN0ID0gbmV3IFJ1bnRpbWVPYmplY3QodGhpcy5zdGF0aWNDbGFzcyk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJjbGVhclNjcmVlblwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgLy8gXSksIG51bGwsXHJcbiAgICAgICAgLy8gICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLnByaW50TWFuYWdlci5jbGVhcigpO1xyXG4gICAgICAgIC8vICAgICB9LCBmYWxzZSwgdHJ1ZSwgXCJMw7ZzY2h0IGRlbiBCaWxkc2NoaXJtXCIpKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImFkZEtleUxpc3RlbmVyXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAvLyAgICAgeyBpZGVudGlmaWVyOiBcImtleUxpc3RlbmVyXCIsIHR5cGU6IG1vZHVsZS50eXBlU3RvcmUuZ2V0VHlwZShcIktleUxpc3RlbmVyXCIpLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfVxyXG4gICAgICAgIC8vIF0pLCBudWxsLFxyXG4gICAgICAgIC8vIChwYXJhbWV0ZXJzKSA9PiB7XHJcbiAgICAgICAgLy8gICAgIGxldCByOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAvLyAgICAgbGV0IG1ldGhvZCA9ICg8S2xhc3M+ci5jbGFzcykuZ2V0TWV0aG9kQnlTaWduYXR1cmUoXCJvbktleVR5cGVkKFN0cmluZylcIik7XHJcblxyXG4gICAgICAgIC8vICAgICBpZiAobWV0aG9kICE9IG51bGwpIHtcclxuXHJcbiAgICAgICAgLy8gICAgICAgICBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLmtleWJvYXJkVG9vbC5rZXlQcmVzc2VkQ2FsbGJhY2tzLnB1c2goKGtleSkgPT4ge1xyXG5cclxuICAgICAgICAvLyAgICAgICAgICAgICBsZXQgcHJvZ3JhbSA9IG1ldGhvZD8ucHJvZ3JhbTtcclxuICAgICAgICAvLyAgICAgICAgICAgICBsZXQgaW52b2tlID0gbWV0aG9kPy5pbnZva2U7XHJcblxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGxldCBzdGFja0VsZW1lbnRzOiBWYWx1ZVtdID0gW1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICB0eXBlOiByLmNsYXNzLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgdHlwZTogc3RyaW5nUHJpbWl0aXZlVHlwZSxcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBrZXlcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGlmIChwcm9ncmFtICE9IG51bGwpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgbW9kdWxlLm1haW4uZ2V0SW50ZXJwcmV0ZXIoKS5ydW5UaW1lcihtZXRob2QsIHN0YWNrRWxlbWVudHMsIG51bGwsIGZhbHNlKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICB9IGVsc2UgaWYgKGludm9rZSAhPSBudWxsKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIGludm9rZShbXSk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy8gICAgICAgICB9KTtcclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vIH0gICAgXHJcbiAgICAgICAgLy8gLCBmYWxzZSwgdHJ1ZSwgXCJGw7xndCBlaW5lbiBLZXlMaXN0ZW5lciBoaW56dSwgZGVzc2VuIE1ldGhvZGUga2V5VHlwZWQgaW1tZXIgZGFubiBhdWZnZXJ1ZmVuIHdpcmQsIHdlbm4gZWluZSBUYXN0ZSBnZWRyw7xja3QgdW5kIGFuc2NobGllw59lbmQgbG9zZ2VsYXNzZW4gd2lyZC5cIikpO1xyXG5cclxuICAgICAgICAvLyB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwicGxheVNvdW5kXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAvLyAgICAgeyBpZGVudGlmaWVyOiBcInNvdW5kXCIsIHR5cGU6IHN0cmluZ1ByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9XHJcbiAgICAgICAgLy8gXSksIG51bGwsXHJcbiAgICAgICAgLy8gKHBhcmFtZXRlcnMpID0+IHtcclxuICAgICAgICAvLyAgICAgbGV0IHNvdW5kOiBzdHJpbmcgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgIC8vICAgICBTb3VuZFRvb2xzLnBsYXkoc291bmQpO1xyXG4gICAgICAgIC8vIH0gICAgXHJcbiAgICAgICAgLy8gLCBmYWxzZSwgdHJ1ZSwgXCJTcGllbHQgZWluZW4gU291bmQgYWIuIERpZSBNw7ZnbGljaGVuIFNvdW5kcyBzaW5kIGFscyBzdGF0aXNjaGUgVmFyaWFibGVuIGRlciBLbGFzc2UgU291bmQgaGludGVybGVndC4gVGlwcGUgYWxzIFBhcmFtZXRlciBhbHNvIFNvdW5kIGdlZm9sZ3Qgdm9uIGVpbmVtIFB1bmt0IGVpbiwgdW0gZWluZSBBdXN3YWhsIHp1IHNlaGVuIVwiKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJjdXJyZW50VGltZU1pbGxpc1wiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgXSksIGludFByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0ZS5ub3coKSArIHRoaXMuZGVsdGFUaW1lTWlsbGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICwgZmFsc2UsIHRydWUsIFwiR2lidCBkaWUgQW56YWhsIGRlciBNaWxsaXNla3VuZGVuLCBkaWUgc2VpdCBkZW0gMDEuMDEuMTk3MCAwMDowMDowMCBVVEMgdmVyZ2FuZ2VuIHNpbmQsIHp1csO8Y2suXCIpKTtcclxuXHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUHJpbnRTdHJlYW1DbGFzcyBleHRlbmRzIEtsYXNzIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihtb2R1bGU6IE1vZHVsZSkge1xyXG4gICAgICAgIHN1cGVyKFwiUHJpbnRTdHJlYW1cIiwgbW9kdWxlLCBcIkludGVybmUgSGlsZnNrbGFzc2UsIHVtIFN5c3RlbS5vdXQucHJpbnRsbiB6dSBlcm3DtmdsaWNoZW4uIERhcyBPYmpla3QgU3lzdGVtLm91dCBpc3Qgdm9uIGRlciBLbGFzc2UgUHJpbnRTdHJlYW0uXCIpO1xyXG5cclxuICAgICAgICB0aGlzLnNldEJhc2VDbGFzcyg8S2xhc3M+bW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiT2JqZWN0XCIpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInByaW50XCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInRleHRcIiwgdHlwZTogc3RyaW5nUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH1cclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuICAgICAgICAgICAgICAgIG1vZHVsZS5tYWluLmdldEludGVycHJldGVyKCkucHJpbnRNYW5hZ2VyLnByaW50KHBhcmFtZXRlcnNbMV0udmFsdWUpO1xyXG4gICAgICAgICAgICB9LCBmYWxzZSwgdHJ1ZSwgXCJHaWJ0IGRlbiBUZXh0IGF1cy5cIikpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwicHJpbnRsblwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJ0ZXh0XCIsIHR5cGU6IHN0cmluZ1ByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9XHJcbiAgICAgICAgXSksIG51bGwsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLnByaW50TWFuYWdlci5wcmludGxuKHBhcmFtZXRlcnNbMV0udmFsdWUpO1xyXG4gICAgICAgICAgICB9LCBmYWxzZSwgdHJ1ZSwgXCJHaWJ0IGRlbiBUZXh0IGF1cywgZ2Vmb2xndCB2b24gZWluZW0gWmVpbGVuc3BydW5nLlwiKSk7XHJcblxyXG5cclxuICAgIH1cclxuXHJcbn0iXX0=