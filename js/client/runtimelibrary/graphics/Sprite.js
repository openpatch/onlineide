import { Klass } from "../../compiler/types/Class.js";
import { doublePrimitiveType, intPrimitiveType, voidPrimitiveType } from "../../compiler/types/PrimitiveTypes.js";
import { Method, Parameterlist } from "../../compiler/types/Types.js";
import { RuntimeObject } from "../../interpreter/RuntimeObject.js";
import { ShapeHelper } from "./Shape.js";
import { HitPolygonStore } from "./PolygonStore.js";
import { ArrayType } from "../../compiler/types/Array.js";
export class SpriteClass extends Klass {
    constructor(module) {
        super("Sprite", module, "Ein Sprite ist eine kleine Pixelgrafik, die verschoben, gedreht und skaliert werden kann. Zudem besitzt es Methoden zum Erkennen von Kollisionen mit anderen grafischen Objekten.");
        this.setBaseClass(module.typeStore.getType("Shape"));
        let scaleModeClass = module.typeStore.getType("ScaleMode");
        // this.addAttribute(new Attribute("PI", doublePrimitiveType, (object) => { return Math.PI }, true, Visibility.public, true, "Die Kreiszahl Pi (3.1415...)"));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "x", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "y", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "scalemode", type: scaleModeClass, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let x = parameters[1].value;
            let y = parameters[2].value;
            let spriteLibraryEntry = parameters[3].value;
            let index = parameters[4].value;
            let scaleMode = parameters[5].value;
            let rh = new SpriteHelper(x, y, spriteLibraryEntry.enumValue.identifier, index, module.main.getInterpreter(), o, scaleMode.enumValue.identifier);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Instanziert ein neues Sprite und stellt es an der Position (x, y) dar. Falls scale ungleich 1 ist wird die Bitmap des Sprites VOR dem Rendern um den Faktor scale gestreckt. Dabei wird die nearest neighbour-Interpolation verwendet damit aus Einzelpixeln schöne Quadrate werden. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', true));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "x", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "y", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let x = parameters[1].value;
            let y = parameters[2].value;
            let spriteLibraryEntry = parameters[3].value;
            let index = parameters[4].value;
            let rh = new SpriteHelper(x, y, spriteLibraryEntry.enumValue.identifier, index, module.main.getInterpreter(), o);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Instanziert ein neues Sprite und stellt es an der Position (x, y) dar. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', true));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "x", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "y", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let x = parameters[1].value;
            let y = parameters[2].value;
            let spriteLibraryEntry = parameters[3].value;
            let rh = new SpriteHelper(x, y, spriteLibraryEntry.enumValue.identifier, null, module.main.getInterpreter(), o);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Instanziert ein neues Sprite und stellt es an der Position (x, y) dar. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', true));
        this.addMethod(new Method("setImage", new Parameterlist([
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let spriteLibraryEntry = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("setImage"))
                return;
            sh.setTexture(spriteLibraryEntry.enumValue.identifier);
        }, false, false, 'Ändert das Bild des Sprites. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', false));
        this.addMethod(new Method("setImage", new Parameterlist([
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let spriteLibraryEntry = parameters[1].value;
            let index = parameters[2].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("setImage"))
                return;
            sh.setTexture(spriteLibraryEntry.enumValue.identifier, index);
        }, false, false, 'Ändert das Bild des Sprites. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', false));
        this.addMethod(new Method("setImageIndex", new Parameterlist([
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let index = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("setImage"))
                return;
            sh.setTexture(sh.textureName, index);
        }, false, false, 'Ändert den Bildindex des Sprites.', false));
        this.addMethod(new Method("playAnimation", new Parameterlist([
            { identifier: "indexArray", type: new ArrayType(intPrimitiveType), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "repeatType", type: module.typeStore.getType("RepeatType"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "imagesPerSecond", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let indexArray = parameters[1].value;
            let repeatType = parameters[2].value;
            let imagesPerSecond = parameters[3].value;
            let sh = o.intrinsicData["Actor"];
            let indices = [];
            for (let v of indexArray) {
                indices.push(v.value);
            }
            if (sh.testdestroyed("playAnimation"))
                return;
            sh.playAnimation(indices, repeatType.enumValue.identifier, imagesPerSecond);
        }, false, false, 'Spielt eine Animation ab.', false));
        this.addMethod(new Method("playAnimation", new Parameterlist([
            { identifier: "fromIndex", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "toIndex", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "repeatType", type: module.typeStore.getType("RepeatType"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "imagesPerSecond", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let fromIndex = parameters[1].value;
            let toIndex = parameters[2].value;
            let repeatType = parameters[3].value;
            let imagesPerSecond = parameters[4].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("playAnimation"))
                return;
            let indices = [];
            if (fromIndex < toIndex && toIndex - fromIndex < 10000) {
                for (let i = fromIndex; i < toIndex; i++)
                    indices.push(i);
            }
            sh.playAnimation(indices, repeatType.enumValue.identifier, imagesPerSecond);
        }, false, false, 'Spielt eine Animation ab.', false));
        this.addMethod(new Method("stopAnimation", new Parameterlist([]), null, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("stopAnimation"))
                return;
            sh.stopAnimation(true);
        }, false, false, 'Stoppt die gerade laufende Animation und macht das Sprite unsichtbar.', false));
        this.addMethod(new Method("pauseAnimation", new Parameterlist([]), null, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("pauseAnimation"))
                return;
            sh.pauseAnimation();
        }, false, false, 'Pausiert die laufende Animation.', false));
        this.addMethod(new Method("resumeAnimation", new Parameterlist([]), null, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("resumeAnimation"))
                return;
            sh.resumeAnimation();
        }, false, false, 'Fährt mit einer pausierten Animation wieder fort.', false));
        this.addMethod(new Method("setAlpha", new Parameterlist([
            { identifier: "alphaValue", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let alpha = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("setAlpha"))
                return;
            sh.setAlpha(alpha);
        }, false, false, 'Setzt die Durchsichtigkeit. 0.0 bedeutet vollkommen durchsichtig, 1.0 bedeutet vollkommen undurchsichtig.', false));
        this.addMethod(new Method("copy", new Parameterlist([]), this, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("copy"))
                return;
            return sh.getCopy(o.class);
        }, false, false, 'Erstellt eine Kopie des Sprite-Objekts und git sie zurück.', false));
        this.addMethod(new Method("getWidth", new Parameterlist([]), doublePrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("getWidth"))
                return;
            return sh.getWidth();
        }, false, false, "Gibt die Breite zurück.", false));
        this.addMethod(new Method("getHeight", new Parameterlist([]), doublePrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("getHeight"))
                return;
            return sh.getHeight();
        }, false, false, "Gibt die Höhe zurück.", false));
    }
}
export class SpriteHelper extends ShapeHelper {
    constructor(x, y, name, index, interpreter, runtimeObject, scaleMode = "linear") {
        super(interpreter, runtimeObject);
        this.x = x;
        this.y = y;
        this.name = name;
        this.index = index;
        this.scaleMode = scaleMode;
        this.animationIndices = [];
        this.animationRuns = false;
        this.imagesPerMillisecond = 1;
        this.animationTime = 0;
        this.animationPaused = false;
        this.repeatType = "once";
        this.textureName = "";
        this.setTexture(null, index);
        let sprite = this.displayObject;
        this.displayObject.localTransform.translate(this.x - sprite.width / 2, this.y - sprite.height / 2);
        this.displayObject.transform.onChange();
        this.worldHelper.stage.addChild(sprite);
        this.centerXInitial = sprite.width / 2;
        this.centerYInitial = sprite.height / 2;
        this.addToDefaultGroup();
    }
    getWidth() {
        let sprite = this.displayObject;
        return sprite.width * this.scaleFactor;
    }
    getHeight() {
        let sprite = this.displayObject;
        return sprite.height * this.scaleFactor;
    }
    getCopy(klass) {
        let ro = new RuntimeObject(klass);
        let rh = new SpriteHelper(this.x, this.y, this.name, this.index, this.worldHelper.interpreter, ro);
        ro.intrinsicData["Actor"] = rh;
        rh.copyFrom(this);
        rh.render();
        return ro;
    }
    setAlpha(alpha) {
        this.displayObject.alpha = alpha;
    }
    setTexture(name, index) {
        if (name == this.name && index == this.index)
            return;
        if (name == null)
            name = this.name;
        if (index == null)
            index = 0;
        this.index = index;
        this.textureName = name;
        let prefix = "";
        //@ts-ignore
        if (window.javaOnlineDir != null) {
            //@ts-ignore
            prefix = window.javaOnlineDir;
        }
        let sheet = PIXI.Loader.shared.resources[prefix + "assets/graphics/spritesheet.json"];
        let nameWithIndex = name + "#" + index;
        let texture = sheet.textures[nameWithIndex];
        if (texture != null) {
            if (this.scaleMode == "nearest_neighbour") {
                let t = this.worldHelper.scaledTextures[nameWithIndex];
                if (t == null) {
                    let sprite = new PIXI.Sprite(texture);
                    let dynamicTexture1 = PIXI.RenderTexture.create({
                        width: sprite.width,
                        height: sprite.height,
                        scaleMode: PIXI.SCALE_MODES.NEAREST
                    });
                    this.worldHelper.app.renderer.render(sprite, dynamicTexture1, true);
                    this.worldHelper.scaledTextures[nameWithIndex] = dynamicTexture1;
                    t = dynamicTexture1;
                }
                texture = t;
                if (texture == null)
                    texture = sheet.textures[nameWithIndex];
                // let t = this.worldHelper.scaledTextures[nameWithIndex][this.scaleOnTextureGeneration];
                // if( t != null){
                //     texture = t;
                // } else {
                //     let sprite = new PIXI.Sprite(texture);
                //     let dynamicTexture1 = PIXI.RenderTexture.create({
                //         width: sprite.width,
                //         height: sprite.height,
                //         scaleMode: PIXI.SCALE_MODES.NEAREST
                //     });
                //     this.worldHelper.app.renderer.render(sprite, dynamicTexture1, true);
                //     sprite = new PIXI.Sprite(dynamicTexture1);
                //     let dynamicTexture2 = PIXI.RenderTexture.create({
                //         width: sprite.width * this.scaleOnTextureGeneration,
                //         height: sprite.height * this.scaleOnTextureGeneration,
                //         scaleMode: PIXI.SCALE_MODES.LINEAR
                //     });
                //     let m = new PIXI.Matrix();
                //     m.scale(this.scaleOnTextureGeneration, this.scaleOnTextureGeneration);
                //     this.worldHelper.app.renderer.render(sprite, dynamicTexture2, true,
                //         m);
                //     texture = dynamicTexture2;
                //     this.worldHelper.scaledTextures[nameWithIndex][this.scaleOnTextureGeneration] = texture;
            }
            let sprite = this.displayObject;
            if (sprite == null) {
                sprite = new PIXI.Sprite(texture);
                this.displayObject = sprite;
            }
            else {
                sprite.texture = texture; // sheet.textures[nameWithIndex];
            }
            this.hitPolygonInitial = HitPolygonStore.getPolygonForTexture(name, index, this, new PIXI.Sprite(sheet.textures[nameWithIndex]));
            this.hitPolygonDirty = true;
        }
        else {
            if (this.displayObject == null) {
                this.displayObject = new PIXI.Sprite();
            }
        }
    }
    render() {
    }
    ;
    playAnimation(indexArray, repeatType, imagesPerSecond) {
        this.stopAnimation(false);
        this.animationIndices = indexArray;
        this.repeatType = repeatType;
        this.imagesPerMillisecond = imagesPerSecond / 1000;
        this.animationTime = 0;
        this.animationRuns = true;
        this.worldHelper.spriteAnimations.push(this);
    }
    stopAnimation(setInvisible) {
        if (this.animationRuns) {
            let spriteHelperList = this.worldHelper.spriteAnimations;
            let i = spriteHelperList.indexOf(this);
            spriteHelperList.splice(i, 1);
        }
        this.animationRuns = false;
        if (setInvisible)
            this.setVisible(false);
    }
    pauseAnimation() {
        this.animationPaused = true;
    }
    resumeAnimation() {
        this.animationPaused = false;
    }
    tick(deltaTime) {
        if (this.animationPaused)
            return;
        let image;
        if (this.repeatType == "backAndForth") {
            let period2 = this.animationIndices.length * 2 / this.imagesPerMillisecond;
            let numberOfPeriodsDone = Math.trunc(this.animationTime / period2);
            let timeIntoPeriod = this.animationTime - numberOfPeriodsDone * period2;
            image = this.imagesPerMillisecond * timeIntoPeriod;
            if (image >= this.animationIndices.length) {
                image = 2 * this.animationIndices.length - image;
            }
            image = Math.trunc(image);
        }
        else if (this.repeatType == "loop") {
            let period = this.animationIndices.length / this.imagesPerMillisecond;
            let numberOfPeriodsDone = Math.trunc(this.animationTime / period);
            let timeIntoPeriod = this.animationTime - numberOfPeriodsDone * period;
            image = this.imagesPerMillisecond * timeIntoPeriod;
            image = Math.trunc(image);
        }
        else {
            image = Math.trunc(this.imagesPerMillisecond * this.animationTime);
            if (image >= this.animationIndices.length) {
                this.stopAnimation(true);
                return;
            }
        }
        this.animationTime += deltaTime;
        this.setTexture(null, this.animationIndices[image]);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3ByaXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NsaWVudC9ydW50aW1lbGlicmFyeS9ncmFwaGljcy9TcHJpdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBQ2xILE9BQU8sRUFBRSxNQUFNLEVBQUUsYUFBYSxFQUFTLE1BQU0sK0JBQStCLENBQUM7QUFDN0UsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBSW5FLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDekMsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUkxRCxNQUFNLE9BQU8sV0FBWSxTQUFRLEtBQUs7SUFFbEMsWUFBWSxNQUFjO1FBRXRCLEtBQUssQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLG1MQUFtTCxDQUFDLENBQUM7UUFFN00sSUFBSSxDQUFDLFlBQVksQ0FBUSxNQUFNLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBRTVELElBQUksY0FBYyxHQUFVLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBRWpFLDhKQUE4SjtRQUU5SixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksTUFBTSxDQUFDLFFBQVEsRUFBRSxJQUFJLGFBQWEsQ0FBQztZQUNsRCxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLElBQUksRUFBRSxPQUFPLEVB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WUFDbkQsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDN0I7YUFBTTtZQUNILEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDbkUsSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRTtnQkFDdkMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDekIsT0FBTzthQUNWO1NBQ0o7UUFFTCxJQUFJLENBQUMsYUFBYSxJQUFJLFNBQVMsQ0FBQztRQUVoQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUN4RCxDQUFDO0NBRUoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNb2R1bGUgfSBmcm9tIFwiLi4vLi4vY29tcGlsZXIvcGFyc2VyL01vZHVsZS5qc1wiO1xyXG5pbXBvcnQgeyBLbGFzcyB9IGZyb20gXCIuLi8uLi9jb21waWxlci90eXBlcy9DbGFzcy5qc1wiO1xyXG5pbXBvcnQgeyBkb3VibGVQcmltaXRpdmVUeXBlLCBpbnRQcmltaXRpdmVUeXBlLCB2b2lkUHJpbWl0aXZlVHlwZSB9IGZyb20gXCIuLi8uLi9jb21waWxlci90eXBlcy9QcmltaXRpdmVUeXBlcy5qc1wiO1xyXG5pbXBvcnQgeyBNZXRob2QsIFBhcmFtZXRlcmxpc3QsIFZhbHVlIH0gZnJvbSBcIi4uLy4uL2NvbXBpbGVyL3R5cGVzL1R5cGVzLmpzXCI7XHJcbmltcG9ydCB7IFJ1bnRpbWVPYmplY3QgfSBmcm9tIFwiLi4vLi4vaW50ZXJwcmV0ZXIvUnVudGltZU9iamVjdC5qc1wiO1xyXG5pbXBvcnQgeyBGaWxsZWRTaGFwZUhlbHBlciB9IGZyb20gXCIuL0ZpbGxlZFNoYXBlLmpzXCI7XHJcbmltcG9ydCB7IFdvcmxkSGVscGVyIH0gZnJvbSBcIi4vV29ybGQuanNcIjtcclxuaW1wb3J0IHsgRW51bVJ1bnRpbWVPYmplY3QgfSBmcm9tIFwiLi4vLi4vY29tcGlsZXIvdHlwZXMvRW51bS5qc1wiO1xyXG5pbXBvcnQgeyBTaGFwZUhlbHBlciB9IGZyb20gXCIuL1NoYXBlLmpzXCI7XHJcbmltcG9ydCB7IEhpdFBvbHlnb25TdG9yZSB9IGZyb20gXCIuL1BvbHlnb25TdG9yZS5qc1wiO1xyXG5pbXBvcnQgeyBBcnJheVR5cGUgfSBmcm9tIFwiLi4vLi4vY29tcGlsZXIvdHlwZXMvQXJyYXkuanNcIjtcclxuaW1wb3J0IHsgSW50ZXJwcmV0ZXIgfSBmcm9tIFwiLi4vLi4vaW50ZXJwcmV0ZXIvSW50ZXJwcmV0ZXIuanNcIjtcclxuaW1wb3J0IHsgU3ByaXRlTGlicmFyeVBhZ2UgfSBmcm9tIFwiLi4vLi4vaGVscC9TcHJpdGVMaWJyYXJ5UGFnZS5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNwcml0ZUNsYXNzIGV4dGVuZHMgS2xhc3Mge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1vZHVsZTogTW9kdWxlKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKFwiU3ByaXRlXCIsIG1vZHVsZSwgXCJFaW4gU3ByaXRlIGlzdCBlaW5lIGtsZWluZSBQaXhlbGdyYWZpaywgZGllIHZlcnNjaG9iZW4sIGdlZHJlaHQgdW5kIHNrYWxpZXJ0IHdlcmRlbiBrYW5uLiBadWRlbSBiZXNpdHp0IGVzIE1ldGhvZGVuIHp1bSBFcmtlbm5lbiB2b24gS29sbGlzaW9uZW4gbWl0IGFuZGVyZW4gZ3JhZmlzY2hlbiBPYmpla3Rlbi5cIik7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0QmFzZUNsYXNzKDxLbGFzcz5tb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTaGFwZVwiKSk7XHJcblxyXG4gICAgICAgIGxldCBzY2FsZU1vZGVDbGFzcyA9IDxLbGFzcz5tb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTY2FsZU1vZGVcIilcclxuXHJcbiAgICAgICAgLy8gdGhpcy5hZGRBdHRyaWJ1dGUobmV3IEF0dHJpYnV0ZShcIlBJXCIsIGRvdWJsZVByaW1pdGl2ZVR5cGUsIChvYmplY3QpID0+IHsgcmV0dXJuIE1hdGguUEkgfSwgdHJ1ZSwgVmlzaWJpbGl0eS5wdWJsaWMsIHRydWUsIFwiRGllIEtyZWlzemFobCBQaSAoMy4xNDE1Li4uKVwiKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJTcHJpdGVcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwieFwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInlcIiwgdHlwZTogZG91YmxlUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzcHJpdGVMaWJyYXJ5RW50cnlcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU3ByaXRlTGlicmFyeVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJpbmRleFwiLCB0eXBlOiBpbnRQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInNjYWxlbW9kZVwiLCB0eXBlOiBzY2FsZU1vZGVDbGFzcywgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCB4OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHk6IG51bWJlciA9IHBhcmFtZXRlcnNbMl0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3ByaXRlTGlicmFyeUVudHJ5OiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbM10udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXg6IG51bWJlciA9IHBhcmFtZXRlcnNbNF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2NhbGVNb2RlOiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbNV0udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHJoID0gbmV3IFNwcml0ZUhlbHBlcih4LCB5LCBzcHJpdGVMaWJyYXJ5RW50cnkuZW51bVZhbHVlLmlkZW50aWZpZXIsIGluZGV4LCBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLCBvLCBzY2FsZU1vZGUuZW51bVZhbHVlLmlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAgICAgby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSByaDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ0luc3RhbnppZXJ0IGVpbiBuZXVlcyBTcHJpdGUgdW5kIHN0ZWxsdCBlcyBhbiBkZXIgUG9zaXRpb24gKHgsIHkpIGRhci4gRmFsbHMgc2NhbGUgdW5nbGVpY2ggMSBpc3Qgd2lyZCBkaWUgQml0bWFwIGRlcyBTcHJpdGVzIFZPUiBkZW0gUmVuZGVybiB1bSBkZW4gRmFrdG9yIHNjYWxlIGdlc3RyZWNrdC4gRGFiZWkgd2lyZCBkaWUgbmVhcmVzdCBuZWlnaGJvdXItSW50ZXJwb2xhdGlvbiB2ZXJ3ZW5kZXQgZGFtaXQgYXVzIEVpbnplbHBpeGVsbiBzY2jDtm5lIFF1YWRyYXRlIHdlcmRlbi4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXV6w6RobHVuZ3N0eXAgKGVudW0pLiBHaWIgZWluZmFjaCBTcHJpdGVMaWJyYXJ5RW50cnkgZ2Vmb2xndCB2b24gZWluZW0gUHVua3QgZWluLCBkYW5uIGVyaMOkbHRzdCBEdSBlaW4gQXVzd2FobCB2b24gQmlsZGVybi4gRWluZW4gw5xiZXJibGljayDDvGJlciBkaWUgQmlsZGVyIGJla29tbXN0IER1IGF1Y2ggw7xiZXIgZGVuIE1lbsO8cHVua3QgSGlsZmUtPlNwcml0ZS1CaWxkZXLDvGJlcnNpY2h0LicsIHRydWUpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcIlNwcml0ZVwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJ4XCIsIHR5cGU6IGRvdWJsZVByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwieVwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInNwcml0ZUxpYnJhcnlFbnRyeVwiLCB0eXBlOiBtb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTcHJpdGVMaWJyYXJ5XCIpLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImluZGV4XCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG5cclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgeDogbnVtYmVyID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCB5OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwcml0ZUxpYnJhcnlFbnRyeTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzNdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGluZGV4OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzRdLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCByaCA9IG5ldyBTcHJpdGVIZWxwZXIoeCwgeSwgc3ByaXRlTGlicmFyeUVudHJ5LmVudW1WYWx1ZS5pZGVudGlmaWVyLCBpbmRleCwgbW9kdWxlLm1haW4uZ2V0SW50ZXJwcmV0ZXIoKSwgbyk7XHJcbiAgICAgICAgICAgICAgICBvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXSA9IHJoO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnSW5zdGFuemllcnQgZWluIG5ldWVzIFNwcml0ZSB1bmQgc3RlbGx0IGVzIGFuIGRlciBQb3NpdGlvbiAoeCwgeSkgZGFyLiBTcHJpdGVMaWJyYXJ5RW50cnkgaXN0IGVpbiBBdXrDpGhsdW5nc3R5cCAoZW51bSkuIEdpYiBlaW5mYWNoIFNwcml0ZUxpYnJhcnlFbnRyeSBnZWZvbGd0IHZvbiBlaW5lbSBQdW5rdCBlaW4sIGRhbm4gZXJow6RsdHN0IER1IGVpbiBBdXN3YWhsIHZvbiBCaWxkZXJuLiBFaW5lbiDDnGJlcmJsaWNrIMO8YmVyIGRpZSBCaWxkZXIgYmVrb21tc3QgRHUgYXVjaCDDvGJlciBkZW4gTWVuw7xwdW5rdCBIaWxmZS0+U3ByaXRlLUJpbGRlcsO8YmVyc2ljaHQuJywgdHJ1ZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwiU3ByaXRlXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInhcIiwgdHlwZTogZG91YmxlUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJ5XCIsIHR5cGU6IGRvdWJsZVByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwic3ByaXRlTGlicmFyeUVudHJ5XCIsIHR5cGU6IG1vZHVsZS50eXBlU3RvcmUuZ2V0VHlwZShcIlNwcml0ZUxpYnJhcnlcIiksIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG5cclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgeDogbnVtYmVyID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCB5OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwcml0ZUxpYnJhcnlFbnRyeTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzNdLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCByaCA9IG5ldyBTcHJpdGVIZWxwZXIoeCwgeSwgc3ByaXRlTGlicmFyeUVudHJ5LmVudW1WYWx1ZS5pZGVudGlmaWVyLCBudWxsLCBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLCBvKTtcclxuICAgICAgICAgICAgICAgIG8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdID0gcmg7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsICdJbnN0YW56aWVydCBlaW4gbmV1ZXMgU3ByaXRlIHVuZCBzdGVsbHQgZXMgYW4gZGVyIFBvc2l0aW9uICh4LCB5KSBkYXIuIFNwcml0ZUxpYnJhcnlFbnRyeSBpc3QgZWluIEF1esOkaGx1bmdzdHlwIChlbnVtKS4gR2liIGVpbmZhY2ggU3ByaXRlTGlicmFyeUVudHJ5IGdlZm9sZ3Qgdm9uIGVpbmVtIFB1bmt0IGVpbiwgZGFubiBlcmjDpGx0c3QgRHUgZWluIEF1c3dhaGwgdm9uIEJpbGRlcm4uIEVpbmVuIMOcYmVyYmxpY2sgw7xiZXIgZGllIEJpbGRlciBiZWtvbW1zdCBEdSBhdWNoIMO8YmVyIGRlbiBNZW7DvHB1bmt0IEhpbGZlLT5TcHJpdGUtQmlsZGVyw7xiZXJzaWNodC4nLCB0cnVlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJzZXRJbWFnZVwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzcHJpdGVMaWJyYXJ5RW50cnlcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU3ByaXRlTGlicmFyeVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzcHJpdGVMaWJyYXJ5RW50cnk6IEVudW1SdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInNldEltYWdlXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgc2guc2V0VGV4dHVyZShzcHJpdGVMaWJyYXJ5RW50cnkuZW51bVZhbHVlLmlkZW50aWZpZXIpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnw4RuZGVydCBkYXMgQmlsZCBkZXMgU3ByaXRlcy4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXV6w6RobHVuZ3N0eXAgKGVudW0pLiBHaWIgZWluZmFjaCBTcHJpdGVMaWJyYXJ5RW50cnkgZ2Vmb2xndCB2b24gZWluZW0gUHVua3QgZWluLCBkYW5uIGVyaMOkbHRzdCBEdSBlaW4gQXVzd2FobCB2b24gQmlsZGVybi4gRWluZW4gw5xiZXJibGljayDDvGJlciBkaWUgQmlsZGVyIGJla29tbXN0IER1IGF1Y2ggw7xiZXIgZGVuIE1lbsO8cHVua3QgSGlsZmUtPlNwcml0ZS1CaWxkZXLDvGJlcnNpY2h0LicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJzZXRJbWFnZVwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzcHJpdGVMaWJyYXJ5RW50cnlcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU3ByaXRlTGlicmFyeVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJpbmRleFwiLCB0eXBlOiBpbnRQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuXHJcbiAgICAgICAgXSksIG51bGwsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwcml0ZUxpYnJhcnlFbnRyeTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGluZGV4OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSA8U3ByaXRlSGVscGVyPm8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwic2V0SW1hZ2VcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5zZXRUZXh0dXJlKHNwcml0ZUxpYnJhcnlFbnRyeS5lbnVtVmFsdWUuaWRlbnRpZmllciwgaW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnw4RuZGVydCBkYXMgQmlsZCBkZXMgU3ByaXRlcy4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXV6w6RobHVuZ3N0eXAgKGVudW0pLiBHaWIgZWluZmFjaCBTcHJpdGVMaWJyYXJ5RW50cnkgZ2Vmb2xndCB2b24gZWluZW0gUHVua3QgZWluLCBkYW5uIGVyaMOkbHRzdCBEdSBlaW4gQXVzd2FobCB2b24gQmlsZGVybi4gRWluZW4gw5xiZXJibGljayDDvGJlciBkaWUgQmlsZGVyIGJla29tbXN0IER1IGF1Y2ggw7xiZXIgZGVuIE1lbsO8cHVua3QgSGlsZmUtPlNwcml0ZS1CaWxkZXLDvGJlcnNpY2h0LicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJzZXRJbWFnZUluZGV4XCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImluZGV4XCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBpbmRleDogbnVtYmVyID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInNldEltYWdlXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgc2guc2V0VGV4dHVyZShzaC50ZXh0dXJlTmFtZSwgaW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnw4RuZGVydCBkZW4gQmlsZGluZGV4IGRlcyBTcHJpdGVzLicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJwbGF5QW5pbWF0aW9uXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImluZGV4QXJyYXlcIiwgdHlwZTogbmV3IEFycmF5VHlwZShpbnRQcmltaXRpdmVUeXBlKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJyZXBlYXRUeXBlXCIsIHR5cGU6IG1vZHVsZS50eXBlU3RvcmUuZ2V0VHlwZShcIlJlcGVhdFR5cGVcIiksIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiaW1hZ2VzUGVyU2Vjb25kXCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG5cclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXhBcnJheTogVmFsdWVbXSA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVwZWF0VHlwZTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGltYWdlc1BlclNlY29uZDogbnVtYmVyID0gcGFyYW1ldGVyc1szXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kaWNlczogbnVtYmVyW10gPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHYgb2YgaW5kZXhBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGljZXMucHVzaCh2LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInBsYXlBbmltYXRpb25cIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5wbGF5QW5pbWF0aW9uKGluZGljZXMsIHJlcGVhdFR5cGUuZW51bVZhbHVlLmlkZW50aWZpZXIsIGltYWdlc1BlclNlY29uZCk7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsICdTcGllbHQgZWluZSBBbmltYXRpb24gYWIuJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInBsYXlBbmltYXRpb25cIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiZnJvbUluZGV4XCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwidG9JbmRleFwiLCB0eXBlOiBpbnRQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInJlcGVhdFR5cGVcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiUmVwZWF0VHlwZVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJpbWFnZXNQZXJTZWNvbmRcIiwgdHlwZTogaW50UHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBmcm9tSW5kZXg6IG51bWJlciA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgdG9JbmRleDogbnVtYmVyID0gcGFyYW1ldGVyc1syXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCByZXBlYXRUeXBlOiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbM10udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW1hZ2VzUGVyU2Vjb25kOiBudW1iZXIgPSBwYXJhbWV0ZXJzWzRdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSA8U3ByaXRlSGVscGVyPm8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwicGxheUFuaW1hdGlvblwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBpbmRpY2VzOiBudW1iZXJbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmcm9tSW5kZXggPCB0b0luZGV4ICYmIHRvSW5kZXggLSBmcm9tSW5kZXggPCAxMDAwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBmcm9tSW5kZXg7IGkgPCB0b0luZGV4OyBpKyspIGluZGljZXMucHVzaChpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzaC5wbGF5QW5pbWF0aW9uKGluZGljZXMsIHJlcGVhdFR5cGUuZW51bVZhbHVlLmlkZW50aWZpZXIsIGltYWdlc1BlclNlY29uZCk7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsICdTcGllbHQgZWluZSBBbmltYXRpb24gYWIuJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInN0b3BBbmltYXRpb25cIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInN0b3BBbmltYXRpb25cIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5zdG9wQW5pbWF0aW9uKHRydWUpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnU3RvcHB0IGRpZSBnZXJhZGUgbGF1ZmVuZGUgQW5pbWF0aW9uIHVuZCBtYWNodCBkYXMgU3ByaXRlIHVuc2ljaHRiYXIuJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInBhdXNlQW5pbWF0aW9uXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2g6IFNwcml0ZUhlbHBlciA9IDxTcHJpdGVIZWxwZXI+by5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJwYXVzZUFuaW1hdGlvblwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnBhdXNlQW5pbWF0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsICdQYXVzaWVydCBkaWUgbGF1ZmVuZGUgQW5pbWF0aW9uLicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJyZXN1bWVBbmltYXRpb25cIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInJlc3VtZUFuaW1hdGlvblwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnJlc3VtZUFuaW1hdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnRsOkaHJ0IG1pdCBlaW5lciBwYXVzaWVydGVuIEFuaW1hdGlvbiB3aWVkZXIgZm9ydC4nLCBmYWxzZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwic2V0QWxwaGFcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiYWxwaGFWYWx1ZVwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICBdKSwgdm9pZFByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGFscGhhOiBudW1iZXIgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSBvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInNldEFscGhhXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgc2guc2V0QWxwaGEoYWxwaGEpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnU2V0enQgZGllIER1cmNoc2ljaHRpZ2tlaXQuIDAuMCBiZWRldXRldCB2b2xsa29tbWVuIGR1cmNoc2ljaHRpZywgMS4wIGJlZGV1dGV0IHZvbGxrb21tZW4gdW5kdXJjaHNpY2h0aWcuJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImNvcHlcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgIF0pLCB0aGlzLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJjb3B5XCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNoLmdldENvcHkoPEtsYXNzPm8uY2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnRXJzdGVsbHQgZWluZSBLb3BpZSBkZXMgU3ByaXRlLU9iamVrdHMgdW5kIGdpdCBzaWUgenVyw7xjay4nLCBmYWxzZSkpO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImdldFdpZHRoXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICBdKSwgZG91YmxlUHJpbWl0aXZlVHlwZSxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2g6IFNwcml0ZUhlbHBlciA9IG8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwiZ2V0V2lkdGhcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2guZ2V0V2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgXCJHaWJ0IGRpZSBCcmVpdGUgenVyw7xjay5cIiwgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImdldEhlaWdodFwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgXSksIGRvdWJsZVByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSBvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcImdldEhlaWdodFwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBzaC5nZXRIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgXCJHaWJ0IGRpZSBIw7ZoZSB6dXLDvGNrLlwiLCBmYWxzZSkpO1xyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTcHJpdGVIZWxwZXIgZXh0ZW5kcyBTaGFwZUhlbHBlciB7XHJcblxyXG4gICAgYW5pbWF0aW9uSW5kaWNlczogbnVtYmVyW10gPSBbXTtcclxuICAgIGFuaW1hdGlvblJ1bnM6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGltYWdlc1Blck1pbGxpc2Vjb25kOiBudW1iZXIgPSAxO1xyXG4gICAgYW5pbWF0aW9uVGltZTogbnVtYmVyID0gMDtcclxuICAgIGFuaW1hdGlvblBhdXNlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIHJlcGVhdFR5cGUgPSBcIm9uY2VcIjtcclxuICAgIHRleHR1cmVOYW1lOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB4OiBudW1iZXIsIHB1YmxpYyB5OiBudW1iZXIsIHB1YmxpYyBuYW1lOiBzdHJpbmcsIHB1YmxpYyBpbmRleDogbnVtYmVyLFxyXG4gICAgICAgIGludGVycHJldGVyOiBJbnRlcnByZXRlciwgcnVudGltZU9iamVjdDogUnVudGltZU9iamVjdCxcclxuICAgICAgICBwdWJsaWMgc2NhbGVNb2RlOiBzdHJpbmcgPSBcImxpbmVhclwiKSB7XHJcbiAgICAgICAgc3VwZXIoaW50ZXJwcmV0ZXIsIHJ1bnRpbWVPYmplY3QpO1xyXG5cclxuICAgICAgICB0aGlzLnNldFRleHR1cmUobnVsbCwgaW5kZXgpO1xyXG5cclxuICAgICAgICBsZXQgc3ByaXRlID0gPFBJWEkuU3ByaXRlPnRoaXMuZGlzcGxheU9iamVjdDtcclxuXHJcbiAgICAgICAgdGhpcy5kaXNwbGF5T2JqZWN0LmxvY2FsVHJhbnNmb3JtLnRyYW5zbGF0ZSh0aGlzLnggLSBzcHJpdGUud2lkdGggLyAyLCB0aGlzLnkgLSBzcHJpdGUuaGVpZ2h0IC8gMik7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5T2JqZWN0LnRyYW5zZm9ybS5vbkNoYW5nZSgpO1xyXG5cclxuICAgICAgICB0aGlzLndvcmxkSGVscGVyLnN0YWdlLmFkZENoaWxkKHNwcml0ZSk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmNlbnRlclhJbml0aWFsID0gc3ByaXRlLndpZHRoIC8gMjtcclxuICAgICAgICB0aGlzLmNlbnRlcllJbml0aWFsID0gc3ByaXRlLmhlaWdodCAvIDI7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkVG9EZWZhdWx0R3JvdXAoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2lkdGgoKTogbnVtYmVyIHtcclxuICAgICAgICBsZXQgc3ByaXRlID0gPFBJWEkuU3ByaXRlPnRoaXMuZGlzcGxheU9iamVjdDtcclxuICAgICAgICByZXR1cm4gc3ByaXRlLndpZHRoICogdGhpcy5zY2FsZUZhY3RvcjtcclxuICAgIH1cclxuXHJcbiAgICBnZXRIZWlnaHQoKTogbnVtYmVyIHtcclxuICAgICAgICBsZXQgc3ByaXRlID0gPFBJWEkuU3ByaXRlPnRoaXMuZGlzcGxheU9iamVjdDtcclxuICAgICAgICByZXR1cm4gc3ByaXRlLmhlaWdodCAqIHRoaXMuc2NhbGVGYWN0b3I7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29weShrbGFzczogS2xhc3MpOiBSdW50aW1lT2JqZWN0IHtcclxuXHJcbiAgICAgICAgbGV0IHJvOiBSdW50aW1lT2JqZWN0ID0gbmV3IFJ1bnRpbWVPYmplY3Qoa2xhc3MpO1xyXG4gICAgICAgIGxldCByaDogU3ByaXRlSGVscGVyID0gbmV3IFNwcml0ZUhlbHBlcih0aGlzLngsIHRoaXMueSwgdGhpcy5uYW1lLCB0aGlzLmluZGV4LCB0aGlzLndvcmxkSGVscGVyLmludGVycHJldGVyLCBybyk7XHJcbiAgICAgICAgcm8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdID0gcmg7XHJcblxyXG4gICAgICAgIHJoLmNvcHlGcm9tKHRoaXMpO1xyXG4gICAgICAgIHJoLnJlbmRlcigpO1xyXG5cclxuICAgICAgICByZXR1cm4gcm87XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHNldEFscGhhKGFscGhhOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3QuYWxwaGEgPSBhbHBoYTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRUZXh0dXJlKG5hbWU/OiBzdHJpbmcsIGluZGV4PzogbnVtYmVyKSB7XHJcblxyXG4gICAgICAgIGlmIChuYW1lID09IHRoaXMubmFtZSAmJiBpbmRleCA9PSB0aGlzLmluZGV4KSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChuYW1lID09IG51bGwpIG5hbWUgPSB0aGlzLm5hbWU7XHJcbiAgICAgICAgaWYgKGluZGV4ID09IG51bGwpIGluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XHJcblxyXG4gICAgICAgIHRoaXMudGV4dHVyZU5hbWUgPSBuYW1lO1xyXG5cclxuICAgICAgICBsZXQgcHJlZml4ID0gXCJcIjtcclxuICAgICAgICAvL0B0cy1pZ25vcmVcclxuICAgICAgICBpZiAod2luZG93LmphdmFPbmxpbmVEaXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvL0B0cy1pZ25vcmVcclxuICAgICAgICAgICAgcHJlZml4ID0gd2luZG93LmphdmFPbmxpbmVEaXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc2hlZXQgPSBQSVhJLkxvYWRlci5zaGFyZWQucmVzb3VyY2VzW3ByZWZpeCArIFwiYXNzZXRzL2dyYXBoaWNzL3Nwcml0ZXNoZWV0Lmpzb25cIl07XHJcbiAgICAgICAgbGV0IG5hbWVXaXRoSW5kZXggPSBuYW1lICsgXCIjXCIgKyBpbmRleDtcclxuICAgICAgICBsZXQgdGV4dHVyZSA9IHNoZWV0LnRleHR1cmVzW25hbWVXaXRoSW5kZXhdO1xyXG5cclxuICAgICAgICBpZiAodGV4dHVyZSAhPSBudWxsKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5zY2FsZU1vZGUgPT0gXCJuZWFyZXN0X25laWdoYm91clwiKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSB0aGlzLndvcmxkSGVscGVyLnNjYWxlZFRleHR1cmVzW25hbWVXaXRoSW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgZHluYW1pY1RleHR1cmUxID0gUElYSS5SZW5kZXJUZXh0dXJlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzcHJpdGUud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogc3ByaXRlLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVNb2RlOiBQSVhJLlNDQUxFX01PREVTLk5FQVJFU1RcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53b3JsZEhlbHBlci5hcHAucmVuZGVyZXIucmVuZGVyKHNwcml0ZSwgZHluYW1pY1RleHR1cmUxLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndvcmxkSGVscGVyLnNjYWxlZFRleHR1cmVzW25hbWVXaXRoSW5kZXhdID0gZHluYW1pY1RleHR1cmUxO1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSBkeW5hbWljVGV4dHVyZTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGV4dHVyZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodGV4dHVyZSA9PSBudWxsKSB0ZXh0dXJlID0gc2hlZXQudGV4dHVyZXNbbmFtZVdpdGhJbmRleF07XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbGV0IHQgPSB0aGlzLndvcmxkSGVscGVyLnNjYWxlZFRleHR1cmVzW25hbWVXaXRoSW5kZXhdW3RoaXMuc2NhbGVPblRleHR1cmVHZW5lcmF0aW9uXTtcclxuICAgICAgICAgICAgICAgIC8vIGlmKCB0ICE9IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHRleHR1cmUgPSB0O1xyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBsZXQgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICBsZXQgZHluYW1pY1RleHR1cmUxID0gUElYSS5SZW5kZXJUZXh0dXJlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHdpZHRoOiBzcHJpdGUud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGhlaWdodDogc3ByaXRlLmhlaWdodCxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgc2NhbGVNb2RlOiBQSVhJLlNDQUxFX01PREVTLk5FQVJFU1RcclxuICAgICAgICAgICAgICAgIC8vICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy53b3JsZEhlbHBlci5hcHAucmVuZGVyZXIucmVuZGVyKHNwcml0ZSwgZHluYW1pY1RleHR1cmUxLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKGR5bmFtaWNUZXh0dXJlMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGxldCBkeW5hbWljVGV4dHVyZTIgPSBQSVhJLlJlbmRlclRleHR1cmUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgd2lkdGg6IHNwcml0ZS53aWR0aCAqIHRoaXMuc2NhbGVPblRleHR1cmVHZW5lcmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBoZWlnaHQ6IHNwcml0ZS5oZWlnaHQgKiB0aGlzLnNjYWxlT25UZXh0dXJlR2VuZXJhdGlvbixcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgc2NhbGVNb2RlOiBQSVhJLlNDQUxFX01PREVTLkxJTkVBUlxyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICBsZXQgbSA9IG5ldyBQSVhJLk1hdHJpeCgpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIG0uc2NhbGUodGhpcy5zY2FsZU9uVGV4dHVyZUdlbmVyYXRpb24sIHRoaXMuc2NhbGVPblRleHR1cmVHZW5lcmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy53b3JsZEhlbHBlci5hcHAucmVuZGVyZXIucmVuZGVyKHNwcml0ZSwgZHluYW1pY1RleHR1cmUyLCB0cnVlLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBtKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGV4dHVyZSA9IGR5bmFtaWNUZXh0dXJlMjtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy53b3JsZEhlbHBlci5zY2FsZWRUZXh0dXJlc1tuYW1lV2l0aEluZGV4XVt0aGlzLnNjYWxlT25UZXh0dXJlR2VuZXJhdGlvbl0gPSB0ZXh0dXJlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgc3ByaXRlOiBQSVhJLlNwcml0ZSA9IDxQSVhJLlNwcml0ZT50aGlzLmRpc3BsYXlPYmplY3Q7XHJcbiAgICAgICAgICAgIGlmIChzcHJpdGUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5T2JqZWN0ID0gc3ByaXRlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnRleHR1cmUgPSB0ZXh0dXJlOyAvLyBzaGVldC50ZXh0dXJlc1tuYW1lV2l0aEluZGV4XTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5oaXRQb2x5Z29uSW5pdGlhbCA9IEhpdFBvbHlnb25TdG9yZS5nZXRQb2x5Z29uRm9yVGV4dHVyZShuYW1lLCBpbmRleCwgdGhpcywgbmV3IFBJWEkuU3ByaXRlKHNoZWV0LnRleHR1cmVzW25hbWVXaXRoSW5kZXhdKSk7XHJcbiAgICAgICAgICAgIHRoaXMuaGl0UG9seWdvbkRpcnR5ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGlzcGxheU9iamVjdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3QgPSBuZXcgUElYSS5TcHJpdGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpOiB2b2lkIHtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHBsYXlBbmltYXRpb24oaW5kZXhBcnJheTogbnVtYmVyW10sIHJlcGVhdFR5cGU6IHN0cmluZywgaW1hZ2VzUGVyU2Vjb25kOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oZmFsc2UpO1xyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uSW5kaWNlcyA9IGluZGV4QXJyYXk7XHJcbiAgICAgICAgdGhpcy5yZXBlYXRUeXBlID0gcmVwZWF0VHlwZTtcclxuICAgICAgICB0aGlzLmltYWdlc1Blck1pbGxpc2Vjb25kID0gaW1hZ2VzUGVyU2Vjb25kIC8gMTAwMDtcclxuICAgICAgICB0aGlzLmFuaW1hdGlvblRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uUnVucyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy53b3JsZEhlbHBlci5zcHJpdGVBbmltYXRpb25zLnB1c2godGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RvcEFuaW1hdGlvbihzZXRJbnZpc2libGU6IGJvb2xlYW4pIHtcclxuICAgICAgICBpZiAodGhpcy5hbmltYXRpb25SdW5zKSB7XHJcbiAgICAgICAgICAgIGxldCBzcHJpdGVIZWxwZXJMaXN0ID0gdGhpcy53b3JsZEhlbHBlci5zcHJpdGVBbmltYXRpb25zO1xyXG4gICAgICAgICAgICBsZXQgaSA9IHNwcml0ZUhlbHBlckxpc3QuaW5kZXhPZih0aGlzKTtcclxuICAgICAgICAgICAgc3ByaXRlSGVscGVyTGlzdC5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uUnVucyA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChzZXRJbnZpc2libGUpIHRoaXMuc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcGF1c2VBbmltYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5hbmltYXRpb25QYXVzZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc3VtZUFuaW1hdGlvbigpIHtcclxuICAgICAgICB0aGlzLmFuaW1hdGlvblBhdXNlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRpY2soZGVsdGFUaW1lOiBudW1iZXIpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uUGF1c2VkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBpbWFnZTogbnVtYmVyO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5yZXBlYXRUeXBlID09IFwiYmFja0FuZEZvcnRoXCIpIHtcclxuICAgICAgICAgICAgbGV0IHBlcmlvZDIgPSB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoICogMiAvIHRoaXMuaW1hZ2VzUGVyTWlsbGlzZWNvbmQ7XHJcbiAgICAgICAgICAgIGxldCBudW1iZXJPZlBlcmlvZHNEb25lID0gTWF0aC50cnVuYyh0aGlzLmFuaW1hdGlvblRpbWUgLyBwZXJpb2QyKTtcclxuICAgICAgICAgICAgbGV0IHRpbWVJbnRvUGVyaW9kID0gdGhpcy5hbmltYXRpb25UaW1lIC0gbnVtYmVyT2ZQZXJpb2RzRG9uZSAqIHBlcmlvZDI7XHJcbiAgICAgICAgICAgIGltYWdlID0gdGhpcy5pbWFnZXNQZXJNaWxsaXNlY29uZCAqIHRpbWVJbnRvUGVyaW9kO1xyXG4gICAgICAgICAgICBpZiAoaW1hZ2UgPj0gdGhpcy5hbmltYXRpb25JbmRpY2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaW1hZ2UgPSAyICogdGhpcy5hbmltYXRpb25JbmRpY2VzLmxlbmd0aCAtIGltYWdlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGltYWdlID0gTWF0aC50cnVuYyhpbWFnZSk7XHJcbiAgICAgICAgfSBlbHNlXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlcGVhdFR5cGUgPT0gXCJsb29wXCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBwZXJpb2QgPSB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoIC8gdGhpcy5pbWFnZXNQZXJNaWxsaXNlY29uZDtcclxuICAgICAgICAgICAgICAgIGxldCBudW1iZXJPZlBlcmlvZHNEb25lID0gTWF0aC50cnVuYyh0aGlzLmFuaW1hdGlvblRpbWUgLyBwZXJpb2QpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbWVJbnRvUGVyaW9kID0gdGhpcy5hbmltYXRpb25UaW1lIC0gbnVtYmVyT2ZQZXJpb2RzRG9uZSAqIHBlcmlvZDtcclxuICAgICAgICAgICAgICAgIGltYWdlID0gdGhpcy5pbWFnZXNQZXJNaWxsaXNlY29uZCAqIHRpbWVJbnRvUGVyaW9kO1xyXG4gICAgICAgICAgICAgICAgaW1hZ2UgPSBNYXRoLnRydW5jKGltYWdlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGltYWdlID0gTWF0aC50cnVuYyh0aGlzLmltYWdlc1Blck1pbGxpc2Vjb25kICogdGhpcy5hbmltYXRpb25UaW1lKTtcclxuICAgICAgICAgICAgICAgIGlmIChpbWFnZSA+PSB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFuaW1hdGlvblRpbWUgKz0gZGVsdGFUaW1lO1xyXG5cclxuICAgICAgICB0aGlzLnNldFRleHR1cmUobnVsbCwgdGhpcy5hbmltYXRpb25JbmRpY2VzW2ltYWdlXSk7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==