import { Klass } from "../../compiler/types/Class.js";
import { doublePrimitiveType, intPrimitiveType, voidPrimitiveType } from "../../compiler/types/PrimitiveTypes.js";
import { Method, Parameterlist } from "../../compiler/types/Types.js";
import { RuntimeObject } from "../../interpreter/RuntimeObject.js";
import { ShapeHelper } from "./Shape.js";
import { HitPolygonStore } from "./PolygonStore.js";
import { ArrayType } from "../../compiler/types/Array.js";
import { convexhull } from "../../tools/ConvexHull.js";
import { GroupHelper } from "./Group.js";
export class SpriteClass extends Klass {
    constructor(module) {
        super("Sprite", module, "Ein Sprite ist eine kleine Pixelgrafik, die verschoben, gedreht und skaliert werden kann. Zudem besitzt es Methoden zum Erkennen von Kollisionen mit anderen grafischen Objekten.");
        this.setBaseClass(module.typeStore.getType("Shape"));
        let scaleModeClass = module.typeStore.getType("ScaleMode");
        // this.addAttribute(new Attribute("PI", doublePrimitiveType, (object) => { return Math.PI }, true, Visibility.public, true, "Die Kreiszahl Pi (3.1415...)"));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "x", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "y", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "scalemode", type: scaleModeClass, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let x = parameters[1].value;
            let y = parameters[2].value;
            let spriteLibraryEntry = parameters[3].value;
            let index = parameters[4].value;
            let scaleMode = parameters[5].value;
            let rh = new SpriteHelper(x, y, spriteLibraryEntry.enumValue.identifier, index, module.main.getInterpreter(), o, null, scaleMode.enumValue.identifier);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Instanziert ein neues Sprite und stellt es an der Position (x, y) dar. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', true));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "shape", type: module.typeStore.getType("Shape"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "scalemode", type: scaleModeClass, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let shape = parameters[1].value;
            let scaleMode = parameters[2].value;
            if (shape == null) {
                module.main.getInterpreter().throwException("Die übergebene Figur ist null.");
                return;
            }
            let rh = new SpriteHelper(0, 0, "", 0, module.main.getInterpreter(), o, shape.intrinsicData["Actor"], scaleMode.enumValue.identifier);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Zeichnet das graphische Objekt (shape) in eine Bitmap und macht daraus ein Sprite. Dieses wird an der Position (x, y) dargestellt.', true));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "shape", type: module.typeStore.getType("Shape"), declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let shape = parameters[1].value;
            if (shape == null) {
                module.main.getInterpreter().throwException("Die übergebene Figur ist null.");
                return;
            }
            let rh = new SpriteHelper(0, 0, "", 0, module.main.getInterpreter(), o, shape.intrinsicData["Actor"], "linear");
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Zeichnet das graphische Objekt (shape) in eine Bitmap und macht daraus ein Sprite. Dieses wird an der Position (x, y) dargestellt.', true));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "x", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "y", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let x = parameters[1].value;
            let y = parameters[2].value;
            let spriteLibraryEntry = parameters[3].value;
            let index = parameters[4].value;
            let rh = new SpriteHelper(x, y, spriteLibraryEntry.enumValue.identifier, index, module.main.getInterpreter(), o);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Instanziert ein neues Sprite und stellt es an der Position (x, y) dar. SpriteLibraryEntry ist ein Aufzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', true));
        this.addMethod(new Method("Sprite", new Parameterlist([
            { identifier: "x", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "y", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let x = parameters[1].value;
            let y = parameters[2].value;
            let spriteLibraryEntry = parameters[3].value;
            let rh = new SpriteHelper(x, y, spriteLibraryEntry.enumValue.identifier, null, module.main.getInterpreter(), o);
            o.intrinsicData["Actor"] = rh;
        }, false, false, 'Instanziert ein neues Sprite und stellt es an der Position (x, y) dar. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', true));
        this.addMethod(new Method("setImage", new Parameterlist([
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let spriteLibraryEntry = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.isDestroyed)
                return;
            sh.setTexture(spriteLibraryEntry.enumValue.identifier);
        }, false, false, 'Ändert das Bild des Sprites. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', false));
        this.addMethod(new Method("setImage", new Parameterlist([
            { identifier: "spriteLibraryEntry", type: module.typeStore.getType("SpriteLibrary"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let spriteLibraryEntry = parameters[1].value;
            let index = parameters[2].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.isDestroyed)
                return;
            sh.setTexture(spriteLibraryEntry.enumValue.identifier, index);
        }, false, false, 'Ändert das Bild des Sprites. SpriteLibraryEntry ist ein Auzählungstyp (enum). Gib einfach SpriteLibraryEntry gefolgt von einem Punkt ein, dann erhältst Du ein Auswahl von Bildern. Einen Überblick über die Bilder bekommst Du auch über den Menüpunkt Hilfe->Sprite-Bilderübersicht.', false));
        this.addMethod(new Method("setImageIndex", new Parameterlist([
            { identifier: "index", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let index = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.isDestroyed)
                return;
            sh.setTexture(sh.textureName, index);
        }, false, false, 'Ändert den Bildindex des Sprites.', false));
        this.addMethod(new Method("playAnimation", new Parameterlist([
            { identifier: "indexArray", type: new ArrayType(intPrimitiveType), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "repeatType", type: module.typeStore.getType("RepeatType"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "imagesPerSecond", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let indexArray = parameters[1].value;
            let repeatType = parameters[2].value;
            let imagesPerSecond = parameters[3].value;
            let sh = o.intrinsicData["Actor"];
            let indices = [];
            for (let v of indexArray) {
                indices.push(v.value);
            }
            if (sh.testdestroyed("playAnimation"))
                return;
            sh.playAnimation(indices, repeatType.enumValue.identifier, imagesPerSecond);
        }, false, false, 'Spielt eine Animation ab.', false));
        this.addMethod(new Method("playAnimation", new Parameterlist([
            { identifier: "fromIndex", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "toIndex", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "repeatType", type: module.typeStore.getType("RepeatType"), declaration: null, usagePositions: null, isFinal: true },
            { identifier: "imagesPerSecond", type: intPrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), null, (parameters) => {
            let o = parameters[0].value;
            let fromIndex = parameters[1].value;
            let toIndex = parameters[2].value;
            let repeatType = parameters[3].value;
            let imagesPerSecond = parameters[4].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("playAnimation"))
                return;
            let indices = [];
            if (Math.abs(toIndex - fromIndex) < 10000) {
                let delta = Math.sign(toIndex - fromIndex);
                for (let i = fromIndex; i != toIndex; i = i + delta)
                    indices.push(i);
            }
            sh.playAnimation(indices, repeatType.enumValue.identifier, imagesPerSecond);
        }, false, false, 'Spielt eine Animation ab.', false));
        this.addMethod(new Method("stopAnimation", new Parameterlist([]), null, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.isDestroyed)
                return;
            sh.stopAnimation(false);
        }, false, false, 'Stoppt die gerade laufende Animation', false));
        this.addMethod(new Method("pauseAnimation", new Parameterlist([]), null, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("pauseAnimation"))
                return;
            sh.pauseAnimation();
        }, false, false, 'Pausiert die laufende Animation.', false));
        this.addMethod(new Method("resumeAnimation", new Parameterlist([]), null, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("resumeAnimation"))
                return;
            sh.resumeAnimation();
        }, false, false, 'Fährt mit einer pausierten Animation wieder fort.', false));
        this.addMethod(new Method("setAlpha", new Parameterlist([
            { identifier: "alphaValue", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let alpha = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("setAlpha"))
                return;
            sh.setAlpha(alpha);
        }, false, false, 'Setzt die Durchsichtigkeit. 0.0 bedeutet vollkommen durchsichtig, 1.0 bedeutet vollkommen undurchsichtig.', false));
        this.addMethod(new Method("copy", new Parameterlist([]), this, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("copy"))
                return;
            return sh.getCopy(o.class);
        }, false, false, 'Erstellt eine Kopie des Sprite-Objekts und git sie zurück.', false));
        this.addMethod(new Method("getWidth", new Parameterlist([]), doublePrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("getWidth"))
                return;
            return sh.getWidth();
        }, false, false, "Gibt die Breite zurück.", false));
        this.addMethod(new Method("getHeight", new Parameterlist([]), doublePrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("getHeight"))
                return;
            return sh.getHeight();
        }, false, false, "Gibt die Höhe zurück.", false));
        this.addMethod(new Method("makeTiling", new Parameterlist([
            { identifier: "width", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "height", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true }
        ]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let width = parameters[1].value;
            let height = parameters[2].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("makeTiling"))
                return;
            sh.makeTiling(width, height);
        }, false, false, "Fügt das identische Bild nach rechts und unten kachelartig ('tile'!) so oft hinzu, bis die angegebene Breite erreicht ist. \nTIPP: Mit der Methode getTileImage() erhält man ein Tile-Objekt, dessen Methoden move, scale, mirrorX und mirrorY sich gleichzeitig auf jede einzelne Kachel auswirken.", false));
        this.addMethod(new Method("getTileImage", new Parameterlist([]), module.typeStore.getType("Tile"), (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("getTileImage"))
                return;
            if (!sh.isTileSprite) {
                sh.worldHelper.interpreter.throwException("Das Sprite hat kein TileImage. Sie müssen es zuerst mit der Methode makeTiling in ein Kachel-Sprite umwandeln.");
                return;
            }
            let ret = new RuntimeObject(module.typeStore.getType("Tile"));
            ret.intrinsicData["Actor"] = new TileHelper(sh);
            return ret;
        }, false, false, "Nachdem das Sprite mittels der Methode 'makeTiling' zum TileSprite gemacht wurde, kann wirken die Methoden move, scale und rotate immer auf den ganzen gekachelten Bereich. Will man das verfielfachte Bild ändern, so bekommt man über diese Methode das Sprite-Objekt, das diesem Bild entspricht. Ruft man für dieses Objekt die Methoden move, rotate oder scale auf, so wirken sie auf jede der einzelnen Kacheln.", false));
    }
}
export class SpriteHelper extends ShapeHelper {
    constructor(x, y, name, index, interpreter, runtimeObject, copyFromOtherShape, scaleMode = "nearest_neighbour") {
        super(interpreter, runtimeObject);
        this.x = x;
        this.y = y;
        this.name = name;
        this.index = index;
        this.scaleMode = scaleMode;
        this.animationIndices = [];
        this.animationRuns = false;
        this.imagesPerMillisecond = 1;
        this.animationTime = 0;
        this.animationPaused = false;
        this.repeatType = "once";
        this.textureName = "";
        this.isTileSprite = false;
        if (copyFromOtherShape == null) {
            this.setTexture(null, index);
        }
        else {
            this.copyBitmapFromShape(copyFromOtherShape);
            let bounds = copyFromOtherShape.displayObject.getBounds();
            this.x = bounds.left + bounds.width / 2;
            this.y = bounds.top + bounds.height / 2;
        }
        let sprite = this.displayObject;
        this.displayObject.localTransform.translate(this.x - sprite.width / 2, this.y - sprite.height / 2);
        //@ts-ignore
        this.displayObject.transform.onChange();
        this.worldHelper.stage.addChild(sprite);
        this.centerXInitial = sprite.width / 2;
        this.centerYInitial = sprite.height / 2;
        this.addToDefaultGroupAndSetDefaultVisibility();
    }
    makeTiling(width, height) {
        width /= this.scaleFactor;
        height /= this.scaleFactor;
        let sprite = this.displayObject;
        let tileSprite = new PIXI.TilingSprite(sprite.texture, width, height);
        sprite.texture.baseTexture.mipmap = PIXI.MIPMAP_MODES.OFF;
        tileSprite.setParent(sprite.parent);
        tileSprite.transform.localTransform.copyFrom(sprite.transform.localTransform);
        //@ts-ignore
        tileSprite.transform.onChange();
        tileSprite.updateTransform();
        // tileSprite.clampMargin = -0.5;
        this.displayObject = tileSprite;
        this.centerXInitial += -sprite.width / 2 + width / 2;
        this.centerYInitial += -sprite.height / 2 + height / 2;
        let left = this.centerXInitial - width / 2;
        let top = this.centerYInitial - height / 2;
        let right = left + width;
        let bottom = top + height;
        this.hitPolygonInitial = [
            { x: left, y: top }, { x: right, y: top }, { x: right, y: bottom }, { x: left, y: bottom }
        ];
        this.setHitPolygonDirty(true);
        sprite.destroy();
        this.isTileSprite = true;
    }
    setTileOffset(x, y) {
        if (this.isTileSprite) {
            let tileSprite = this.displayObject;
            tileSprite.tilePosition.set(x, y);
        }
    }
    copyBitmapFromShape(copyFromOtherShape) {
        let bounds = copyFromOtherShape.displayObject.getBounds();
        let width = bounds.width;
        let height = bounds.height;
        const brt = new PIXI.BaseRenderTexture({
            scaleMode: this.scaleMode == "nearest_neighbour" ? PIXI.SCALE_MODES.NEAREST : PIXI.SCALE_MODES.LINEAR,
            width: width,
            height: height
        });
        let rt = new PIXI.RenderTexture(brt);
        let dob = copyFromOtherShape.displayObject;
        this.worldHelper.app.renderer.render(dob, {
            renderTexture: rt,
            transform: new PIXI.Matrix().translate(-bounds.left, -bounds.top)
        });
        let points = [];
        points = this.extractPoints(copyFromOtherShape, points);
        for (let p of points) {
            p.x -= bounds.left;
            p.y -= bounds.top;
        }
        this.hitPolygonInitial = points;
        this.hitPolygonInitial = convexhull.makeHull(points);
        this.hitPolygonDirty = true;
        this.displayObject = new PIXI.Sprite(rt);
        copyFromOtherShape.setHitPolygonDirty(true);
    }
    extractPoints(shapeHelper, points) {
        if (shapeHelper instanceof GroupHelper) {
            for (let sh of shapeHelper.shapes) {
                points = this.extractPoints(sh.intrinsicData["Actor"], points);
            }
            return points;
        }
        else {
            if (shapeHelper.hitPolygonDirty)
                shapeHelper.transformHitPolygon();
            return points.concat(shapeHelper.hitPolygonTransformed.map(function (punkt) { return { x: punkt.x, y: punkt.y }; }));
        }
    }
    getWidth() {
        let sprite = this.displayObject;
        return sprite.width * this.scaleFactor;
    }
    getHeight() {
        let sprite = this.displayObject;
        return sprite.height * this.scaleFactor;
    }
    getCopy(klass) {
        let ro = new RuntimeObject(klass);
        let rh = new SpriteHelper(this.x, this.y, this.name, this.index, this.worldHelper.interpreter, ro);
        ro.intrinsicData["Actor"] = rh;
        rh.copyFrom(this);
        rh.render();
        return ro;
    }
    setAlpha(alpha) {
        this.displayObject.alpha = alpha;
    }
    setTexture(name, index) {
        if (name == this.name && index == this.index)
            return;
        if (name == null)
            name = this.name;
        if (index == null)
            index = 0;
        this.index = index;
        this.textureName = name;
        // let prefix = "";
        // //@ts-ignore
        // if (window.javaOnlineDir != null) {
        //     //@ts-ignore
        //     prefix = window.javaOnlineDir;
        // }
        // let sheet = PIXI.Loader.shared.resources[prefix + "assets/graphics/spritesheet.json"].spritesheet;
        let sheet = PIXI.Loader.shared.resources["spritesheet"].spritesheet;
        let nameWithIndex = name + "#" + index;
        let texture = sheet.textures[nameWithIndex];
        if (texture != null) {
            if (this.scaleMode == "linear") {
                let t = this.worldHelper.scaledTextures[nameWithIndex];
                if (t == null) {
                    let sprite = new PIXI.Sprite(texture);
                    let dynamicTexture1 = PIXI.RenderTexture.create({
                        width: sprite.width,
                        height: sprite.height,
                        scaleMode: PIXI.SCALE_MODES.LINEAR
                    });
                    this.worldHelper.app.renderer.render(sprite, {
                        renderTexture: dynamicTexture1
                    });
                    this.worldHelper.scaledTextures[nameWithIndex] = dynamicTexture1;
                    t = dynamicTexture1;
                }
                texture = t;
                if (texture == null)
                    texture = sheet.textures[nameWithIndex];
                // let t = this.worldHelper.scaledTextures[nameWithIndex][this.scaleOnTextureGeneration];
                // if( t != null){
                //     texture = t;
                // } else {
                //     let sprite = new PIXI.Sprite(texture);
                //     let dynamicTexture1 = PIXI.RenderTexture.create({
                //         width: sprite.width,
                //         height: sprite.height,
                //         scaleMode: PIXI.SCALE_MODES.NEAREST
                //     });
                //     this.worldHelper.app.renderer.render(sprite, dynamicTexture1, true);
                //     sprite = new PIXI.Sprite(dynamicTexture1);
                //     let dynamicTexture2 = PIXI.RenderTexture.create({
                //         width: sprite.width * this.scaleOnTextureGeneration,
                //         height: sprite.height * this.scaleOnTextureGeneration,
                //         scaleMode: PIXI.SCALE_MODES.LINEAR
                //     });
                //     let m = new PIXI.Matrix();
                //     m.scale(this.scaleOnTextureGeneration, this.scaleOnTextureGeneration);
                //     this.worldHelper.app.renderer.render(sprite, dynamicTexture2, true,
                //         m);
                //     texture = dynamicTexture2;
                //     this.worldHelper.scaledTextures[nameWithIndex][this.scaleOnTextureGeneration] = texture;
            }
            let sprite = this.displayObject;
            if (sprite == null) {
                sprite = new PIXI.Sprite(texture);
                this.displayObject = sprite;
            }
            else {
                sprite.texture = texture; // sheet.textures[nameWithIndex];
            }
            this.hitPolygonInitial = HitPolygonStore.getPolygonForTexture(name, index, this, new PIXI.Sprite(sheet.textures[nameWithIndex]));
            this.hitPolygonDirty = true;
        }
        else {
            if (this.displayObject == null) {
                this.displayObject = new PIXI.Sprite();
            }
        }
    }
    render() {
    }
    ;
    playAnimation(indexArray, repeatType, imagesPerSecond) {
        this.stopAnimation(false);
        this.animationIndices = indexArray;
        this.repeatType = repeatType;
        this.imagesPerMillisecond = imagesPerSecond / 1000;
        this.animationTime = 0;
        this.animationRuns = true;
        this.worldHelper.spriteAnimations.push(this);
    }
    stopAnimation(setInvisible) {
        if (this.animationRuns) {
            let spriteHelperList = this.worldHelper.spriteAnimations;
            let i = spriteHelperList.indexOf(this);
            if (i >= 0)
                spriteHelperList.splice(i, 1);
        }
        this.animationRuns = false;
        if (setInvisible)
            this.setVisible(false);
    }
    pauseAnimation() {
        this.animationPaused = true;
    }
    resumeAnimation() {
        this.animationPaused = false;
    }
    tick(deltaTime) {
        if (this.animationPaused)
            return;
        let image;
        if (this.repeatType == "backAndForth") {
            let period2 = this.animationIndices.length * 2 / this.imagesPerMillisecond;
            let numberOfPeriodsDone = Math.trunc(this.animationTime / period2);
            let timeIntoPeriod = this.animationTime - numberOfPeriodsDone * period2;
            image = this.imagesPerMillisecond * timeIntoPeriod;
            if (image >= this.animationIndices.length) {
                image = Math.max(2 * this.animationIndices.length - 0.1 - image, 0);
            }
            image = Math.trunc(image);
        }
        else if (this.repeatType == "loop") {
            let period = this.animationIndices.length / this.imagesPerMillisecond;
            let numberOfPeriodsDone = Math.trunc(this.animationTime / period);
            let timeIntoPeriod = this.animationTime - numberOfPeriodsDone * period;
            image = this.imagesPerMillisecond * timeIntoPeriod;
            image = Math.trunc(image);
        }
        else {
            image = Math.trunc(this.imagesPerMillisecond * this.animationTime);
            if (image >= this.animationIndices.length) {
                this.stopAnimation(true);
                return;
            }
        }
        this.animationTime += deltaTime;
        this.setTexture(null, this.animationIndices[image]);
    }
}
export class TileClass extends Klass {
    constructor(module) {
        super("Tile", module, "Eine Kachel in einem Sprite, das mithilfe der Methode makeTiling zu einer Kachelfläche gemacht wurde.");
        this.setBaseClass(module.typeStore.getType("Object"));
        this.addMethod(new Method("move", new Parameterlist([
            { identifier: "dx", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
            { identifier: "dy", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let dx = parameters[1].value;
            let dy = parameters[2].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("move"))
                return;
            sh.move(dx, dy);
        }, false, false, "Verschiebt das Grafikobjekt um dx Pixel nach rechts und um dy Pixel nach unten.", false));
        this.addMethod(new Method("scale", new Parameterlist([
            { identifier: "factor", type: doublePrimitiveType, declaration: null, usagePositions: null, isFinal: true },
        ]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let factor = parameters[1].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("scale"))
                return;
            sh.scale(factor, factor);
        }, false, false, "Streckt das Grafikobjekt um den angegebenen Faktor. Das Zentrum der Streckung ist der 'Mittelpunkt' des Objekts.", false));
        this.addMethod(new Method("mirrorX", new Parameterlist([]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("mirrorX"))
                return;
            sh.scale(-1, 1);
        }, false, false, "Spiegelt das Objekt in X-Richtung.", false));
        this.addMethod(new Method("mirrorY", new Parameterlist([]), voidPrimitiveType, (parameters) => {
            let o = parameters[0].value;
            let sh = o.intrinsicData["Actor"];
            if (sh.testdestroyed("mirrorX"))
                return;
            sh.scale(1, -1);
        }, false, false, "Spiegelt das Objekt in Y-Richtung.", false));
    }
}
export class TileHelper {
    constructor(spriteHelper) {
        this.spriteHelper = spriteHelper;
    }
    move(dx, dy) {
        let tileSprite = this.spriteHelper.displayObject;
        tileSprite.tilePosition.x += dx;
        tileSprite.tilePosition.y += dy;
    }
    scale(fx, fy) {
        let tileSprite = this.spriteHelper.displayObject;
        tileSprite.tileScale.x *= fx;
        tileSprite.tileScale.y *= fy;
    }
    testdestroyed(method) {
        return this.spriteHelper.testdestroyed(method);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3ByaXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NsaWVudC9ydW50aW1lbGlicmFyeS9ncmFwaGljcy9TcHJpdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBQ2xILE9BQU8sRUFBRSxNQUFNLEVBQUUsYUFBYSxFQUFTLE1BQU0sK0JBQStCLENBQUM7QUFDN0UsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG9DQUFvQyxDQUFDO0FBSW5FLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDekMsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUkxRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUV6QyxNQUFNLE9BQU8sV0FBWSxTQUFRLEtBQUs7SUFFbEMsWUFBWSxNQUFjO1FBRXRCLEtBQUssQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLG1MQUFtTCxDQUFDLENBQUM7UUFFN00sSUFBSSxDQUFDLFlBQVksQ0FBUSxNQUFNLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBRTVELElBQUksY0FBYyxHQUFVLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBRWpFLDhKQUE4SjtRQUU5SixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksTUFBTSxDQUFDLFFBQVEsRUFBRSxJQUFJLGFBQWEsQ0FBQztZQUNsRCxFQUFFLFVBQVUsRUFB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QUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2pDLENBQUM7SUFFRCxhQUFhLENBQUMsTUFBYztRQUN4QixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ25ELENBQUM7Q0FHSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1vZHVsZSB9IGZyb20gXCIuLi8uLi9jb21waWxlci9wYXJzZXIvTW9kdWxlLmpzXCI7XHJcbmltcG9ydCB7IEtsYXNzIH0gZnJvbSBcIi4uLy4uL2NvbXBpbGVyL3R5cGVzL0NsYXNzLmpzXCI7XHJcbmltcG9ydCB7IGRvdWJsZVByaW1pdGl2ZVR5cGUsIGludFByaW1pdGl2ZVR5cGUsIHZvaWRQcmltaXRpdmVUeXBlIH0gZnJvbSBcIi4uLy4uL2NvbXBpbGVyL3R5cGVzL1ByaW1pdGl2ZVR5cGVzLmpzXCI7XHJcbmltcG9ydCB7IE1ldGhvZCwgUGFyYW1ldGVybGlzdCwgVmFsdWUgfSBmcm9tIFwiLi4vLi4vY29tcGlsZXIvdHlwZXMvVHlwZXMuanNcIjtcclxuaW1wb3J0IHsgUnVudGltZU9iamVjdCB9IGZyb20gXCIuLi8uLi9pbnRlcnByZXRlci9SdW50aW1lT2JqZWN0LmpzXCI7XHJcbmltcG9ydCB7IEZpbGxlZFNoYXBlSGVscGVyIH0gZnJvbSBcIi4vRmlsbGVkU2hhcGUuanNcIjtcclxuaW1wb3J0IHsgV29ybGRIZWxwZXIgfSBmcm9tIFwiLi9Xb3JsZC5qc1wiO1xyXG5pbXBvcnQgeyBFbnVtUnVudGltZU9iamVjdCB9IGZyb20gXCIuLi8uLi9jb21waWxlci90eXBlcy9FbnVtLmpzXCI7XHJcbmltcG9ydCB7IFNoYXBlSGVscGVyIH0gZnJvbSBcIi4vU2hhcGUuanNcIjtcclxuaW1wb3J0IHsgSGl0UG9seWdvblN0b3JlIH0gZnJvbSBcIi4vUG9seWdvblN0b3JlLmpzXCI7XHJcbmltcG9ydCB7IEFycmF5VHlwZSB9IGZyb20gXCIuLi8uLi9jb21waWxlci90eXBlcy9BcnJheS5qc1wiO1xyXG5pbXBvcnQgeyBJbnRlcnByZXRlciB9IGZyb20gXCIuLi8uLi9pbnRlcnByZXRlci9JbnRlcnByZXRlci5qc1wiO1xyXG5pbXBvcnQgeyBTcHJpdGVMaWJyYXJ5UGFnZSB9IGZyb20gXCIuLi8uLi9oZWxwL1Nwcml0ZUxpYnJhcnlQYWdlLmpzXCI7XHJcbmltcG9ydCB7IFJlbmRlclRleHR1cmUgfSBmcm9tIFwiQHBpeGkvY29yZVwiO1xyXG5pbXBvcnQgeyBjb252ZXhodWxsIH0gZnJvbSBcIi4uLy4uL3Rvb2xzL0NvbnZleEh1bGwuanNcIjtcclxuaW1wb3J0IHsgR3JvdXBIZWxwZXIgfSBmcm9tIFwiLi9Hcm91cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNwcml0ZUNsYXNzIGV4dGVuZHMgS2xhc3Mge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1vZHVsZTogTW9kdWxlKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKFwiU3ByaXRlXCIsIG1vZHVsZSwgXCJFaW4gU3ByaXRlIGlzdCBlaW5lIGtsZWluZSBQaXhlbGdyYWZpaywgZGllIHZlcnNjaG9iZW4sIGdlZHJlaHQgdW5kIHNrYWxpZXJ0IHdlcmRlbiBrYW5uLiBadWRlbSBiZXNpdHp0IGVzIE1ldGhvZGVuIHp1bSBFcmtlbm5lbiB2b24gS29sbGlzaW9uZW4gbWl0IGFuZGVyZW4gZ3JhZmlzY2hlbiBPYmpla3Rlbi5cIik7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0QmFzZUNsYXNzKDxLbGFzcz5tb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTaGFwZVwiKSk7XHJcblxyXG4gICAgICAgIGxldCBzY2FsZU1vZGVDbGFzcyA9IDxLbGFzcz5tb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTY2FsZU1vZGVcIilcclxuXHJcbiAgICAgICAgLy8gdGhpcy5hZGRBdHRyaWJ1dGUobmV3IEF0dHJpYnV0ZShcIlBJXCIsIGRvdWJsZVByaW1pdGl2ZVR5cGUsIChvYmplY3QpID0+IHsgcmV0dXJuIE1hdGguUEkgfSwgdHJ1ZSwgVmlzaWJpbGl0eS5wdWJsaWMsIHRydWUsIFwiRGllIEtyZWlzemFobCBQaSAoMy4xNDE1Li4uKVwiKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJTcHJpdGVcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwieFwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInlcIiwgdHlwZTogZG91YmxlUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzcHJpdGVMaWJyYXJ5RW50cnlcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU3ByaXRlTGlicmFyeVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJpbmRleFwiLCB0eXBlOiBpbnRQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInNjYWxlbW9kZVwiLCB0eXBlOiBzY2FsZU1vZGVDbGFzcywgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCB4OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHk6IG51bWJlciA9IHBhcmFtZXRlcnNbMl0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3ByaXRlTGlicmFyeUVudHJ5OiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbM10udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXg6IG51bWJlciA9IHBhcmFtZXRlcnNbNF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2NhbGVNb2RlOiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbNV0udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHJoID0gbmV3IFNwcml0ZUhlbHBlcih4LCB5LCBzcHJpdGVMaWJyYXJ5RW50cnkuZW51bVZhbHVlLmlkZW50aWZpZXIsIGluZGV4LCBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLCBvLCBudWxsLCBzY2FsZU1vZGUuZW51bVZhbHVlLmlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAgICAgby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSByaDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ0luc3RhbnppZXJ0IGVpbiBuZXVlcyBTcHJpdGUgdW5kIHN0ZWxsdCBlcyBhbiBkZXIgUG9zaXRpb24gKHgsIHkpIGRhci4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXV6w6RobHVuZ3N0eXAgKGVudW0pLiBHaWIgZWluZmFjaCBTcHJpdGVMaWJyYXJ5RW50cnkgZ2Vmb2xndCB2b24gZWluZW0gUHVua3QgZWluLCBkYW5uIGVyaMOkbHRzdCBEdSBlaW4gQXVzd2FobCB2b24gQmlsZGVybi4gRWluZW4gw5xiZXJibGljayDDvGJlciBkaWUgQmlsZGVyIGJla29tbXN0IER1IGF1Y2ggw7xiZXIgZGVuIE1lbsO8cHVua3QgSGlsZmUtPlNwcml0ZS1CaWxkZXLDvGJlcnNpY2h0LicsIHRydWUpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcIlNwcml0ZVwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzaGFwZVwiLCB0eXBlOiBtb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTaGFwZVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzY2FsZW1vZGVcIiwgdHlwZTogc2NhbGVNb2RlQ2xhc3MsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG5cclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2hhcGU6IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNjYWxlTW9kZTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlLm1haW4uZ2V0SW50ZXJwcmV0ZXIoKS50aHJvd0V4Y2VwdGlvbihcIkRpZSDDvGJlcmdlYmVuZSBGaWd1ciBpc3QgbnVsbC5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxldCByaCA9IG5ldyBTcHJpdGVIZWxwZXIoMCwgMCwgXCJcIiwgMCwgbW9kdWxlLm1haW4uZ2V0SW50ZXJwcmV0ZXIoKSwgbywgc2hhcGUuaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdLCBzY2FsZU1vZGUuZW51bVZhbHVlLmlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAgICAgby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSByaDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ1plaWNobmV0IGRhcyBncmFwaGlzY2hlIE9iamVrdCAoc2hhcGUpIGluIGVpbmUgQml0bWFwIHVuZCBtYWNodCBkYXJhdXMgZWluIFNwcml0ZS4gRGllc2VzIHdpcmQgYW4gZGVyIFBvc2l0aW9uICh4LCB5KSBkYXJnZXN0ZWxsdC4nLCB0cnVlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJTcHJpdGVcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwic2hhcGVcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU2hhcGVcIiksIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaGFwZTogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLnRocm93RXhjZXB0aW9uKFwiRGllIMO8YmVyZ2ViZW5lIEZpZ3VyIGlzdCBudWxsLlwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHJoID0gbmV3IFNwcml0ZUhlbHBlcigwLCAwLCBcIlwiLCAwLCBtb2R1bGUubWFpbi5nZXRJbnRlcnByZXRlcigpLCBvLCBzaGFwZS5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0sIFwibGluZWFyXCIpO1xyXG4gICAgICAgICAgICAgICAgby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSByaDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ1plaWNobmV0IGRhcyBncmFwaGlzY2hlIE9iamVrdCAoc2hhcGUpIGluIGVpbmUgQml0bWFwIHVuZCBtYWNodCBkYXJhdXMgZWluIFNwcml0ZS4gRGllc2VzIHdpcmQgYW4gZGVyIFBvc2l0aW9uICh4LCB5KSBkYXJnZXN0ZWxsdC4nLCB0cnVlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJTcHJpdGVcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwieFwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInlcIiwgdHlwZTogZG91YmxlUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzcHJpdGVMaWJyYXJ5RW50cnlcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU3ByaXRlTGlicmFyeVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJpbmRleFwiLCB0eXBlOiBpbnRQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuXHJcbiAgICAgICAgXSksIG51bGwsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHg6IG51bWJlciA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgeTogbnVtYmVyID0gcGFyYW1ldGVyc1syXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzcHJpdGVMaWJyYXJ5RW50cnk6IEVudW1SdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1szXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBpbmRleDogbnVtYmVyID0gcGFyYW1ldGVyc1s0XS52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgcmggPSBuZXcgU3ByaXRlSGVscGVyKHgsIHksIHNwcml0ZUxpYnJhcnlFbnRyeS5lbnVtVmFsdWUuaWRlbnRpZmllciwgaW5kZXgsIG1vZHVsZS5tYWluLmdldEludGVycHJldGVyKCksIG8pO1xyXG4gICAgICAgICAgICAgICAgby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSByaDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ0luc3RhbnppZXJ0IGVpbiBuZXVlcyBTcHJpdGUgdW5kIHN0ZWxsdCBlcyBhbiBkZXIgUG9zaXRpb24gKHgsIHkpIGRhci4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXVmesOkaGx1bmdzdHlwIChlbnVtKS4gR2liIGVpbmZhY2ggU3ByaXRlTGlicmFyeUVudHJ5IGdlZm9sZ3Qgdm9uIGVpbmVtIFB1bmt0IGVpbiwgZGFubiBlcmjDpGx0c3QgRHUgZWluIEF1c3dhaGwgdm9uIEJpbGRlcm4uIEVpbmVuIMOcYmVyYmxpY2sgw7xiZXIgZGllIEJpbGRlciBiZWtvbW1zdCBEdSBhdWNoIMO8YmVyIGRlbiBNZW7DvHB1bmt0IEhpbGZlLT5TcHJpdGUtQmlsZGVyw7xiZXJzaWNodC4nLCB0cnVlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJTcHJpdGVcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwieFwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInlcIiwgdHlwZTogZG91YmxlUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJzcHJpdGVMaWJyYXJ5RW50cnlcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiU3ByaXRlTGlicmFyeVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCB4OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHk6IG51bWJlciA9IHBhcmFtZXRlcnNbMl0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3ByaXRlTGlicmFyeUVudHJ5OiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbM10udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHJoID0gbmV3IFNwcml0ZUhlbHBlcih4LCB5LCBzcHJpdGVMaWJyYXJ5RW50cnkuZW51bVZhbHVlLmlkZW50aWZpZXIsIG51bGwsIG1vZHVsZS5tYWluLmdldEludGVycHJldGVyKCksIG8pO1xyXG4gICAgICAgICAgICAgICAgby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSByaDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ0luc3RhbnppZXJ0IGVpbiBuZXVlcyBTcHJpdGUgdW5kIHN0ZWxsdCBlcyBhbiBkZXIgUG9zaXRpb24gKHgsIHkpIGRhci4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXV6w6RobHVuZ3N0eXAgKGVudW0pLiBHaWIgZWluZmFjaCBTcHJpdGVMaWJyYXJ5RW50cnkgZ2Vmb2xndCB2b24gZWluZW0gUHVua3QgZWluLCBkYW5uIGVyaMOkbHRzdCBEdSBlaW4gQXVzd2FobCB2b24gQmlsZGVybi4gRWluZW4gw5xiZXJibGljayDDvGJlciBkaWUgQmlsZGVyIGJla29tbXN0IER1IGF1Y2ggw7xiZXIgZGVuIE1lbsO8cHVua3QgSGlsZmUtPlNwcml0ZS1CaWxkZXLDvGJlcnNpY2h0LicsIHRydWUpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInNldEltYWdlXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInNwcml0ZUxpYnJhcnlFbnRyeVwiLCB0eXBlOiBtb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJTcHJpdGVMaWJyYXJ5XCIpLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuXHJcbiAgICAgICAgXSksIG51bGwsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwcml0ZUxpYnJhcnlFbnRyeTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSA8U3ByaXRlSGVscGVyPm8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC5pc0Rlc3Ryb3llZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnNldFRleHR1cmUoc3ByaXRlTGlicmFyeUVudHJ5LmVudW1WYWx1ZS5pZGVudGlmaWVyKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ8OEbmRlcnQgZGFzIEJpbGQgZGVzIFNwcml0ZXMuIFNwcml0ZUxpYnJhcnlFbnRyeSBpc3QgZWluIEF1esOkaGx1bmdzdHlwIChlbnVtKS4gR2liIGVpbmZhY2ggU3ByaXRlTGlicmFyeUVudHJ5IGdlZm9sZ3Qgdm9uIGVpbmVtIFB1bmt0IGVpbiwgZGFubiBlcmjDpGx0c3QgRHUgZWluIEF1c3dhaGwgdm9uIEJpbGRlcm4uIEVpbmVuIMOcYmVyYmxpY2sgw7xiZXIgZGllIEJpbGRlciBiZWtvbW1zdCBEdSBhdWNoIMO8YmVyIGRlbiBNZW7DvHB1bmt0IEhpbGZlLT5TcHJpdGUtQmlsZGVyw7xiZXJzaWNodC4nLCBmYWxzZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwic2V0SW1hZ2VcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwic3ByaXRlTGlicmFyeUVudHJ5XCIsIHR5cGU6IG1vZHVsZS50eXBlU3RvcmUuZ2V0VHlwZShcIlNwcml0ZUxpYnJhcnlcIiksIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiaW5kZXhcIiwgdHlwZTogaW50UHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzcHJpdGVMaWJyYXJ5RW50cnk6IEVudW1SdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBpbmRleDogbnVtYmVyID0gcGFyYW1ldGVyc1syXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2guaXNEZXN0cm95ZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5zZXRUZXh0dXJlKHNwcml0ZUxpYnJhcnlFbnRyeS5lbnVtVmFsdWUuaWRlbnRpZmllciwgaW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnw4RuZGVydCBkYXMgQmlsZCBkZXMgU3ByaXRlcy4gU3ByaXRlTGlicmFyeUVudHJ5IGlzdCBlaW4gQXV6w6RobHVuZ3N0eXAgKGVudW0pLiBHaWIgZWluZmFjaCBTcHJpdGVMaWJyYXJ5RW50cnkgZ2Vmb2xndCB2b24gZWluZW0gUHVua3QgZWluLCBkYW5uIGVyaMOkbHRzdCBEdSBlaW4gQXVzd2FobCB2b24gQmlsZGVybi4gRWluZW4gw5xiZXJibGljayDDvGJlciBkaWUgQmlsZGVyIGJla29tbXN0IER1IGF1Y2ggw7xiZXIgZGVuIE1lbsO8cHVua3QgSGlsZmUtPlNwcml0ZS1CaWxkZXLDvGJlcnNpY2h0LicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJzZXRJbWFnZUluZGV4XCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImluZGV4XCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBpbmRleDogbnVtYmVyID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2guaXNEZXN0cm95ZWQpIHJldHVybjtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgc2guc2V0VGV4dHVyZShzaC50ZXh0dXJlTmFtZSwgaW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnw4RuZGVydCBkZW4gQmlsZGluZGV4IGRlcyBTcHJpdGVzLicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJwbGF5QW5pbWF0aW9uXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImluZGV4QXJyYXlcIiwgdHlwZTogbmV3IEFycmF5VHlwZShpbnRQcmltaXRpdmVUeXBlKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJyZXBlYXRUeXBlXCIsIHR5cGU6IG1vZHVsZS50eXBlU3RvcmUuZ2V0VHlwZShcIlJlcGVhdFR5cGVcIiksIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiaW1hZ2VzUGVyU2Vjb25kXCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG5cclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXhBcnJheTogVmFsdWVbXSA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVwZWF0VHlwZTogRW51bVJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGltYWdlc1BlclNlY29uZDogbnVtYmVyID0gcGFyYW1ldGVyc1szXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kaWNlczogbnVtYmVyW10gPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHYgb2YgaW5kZXhBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGljZXMucHVzaCh2LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInBsYXlBbmltYXRpb25cIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5wbGF5QW5pbWF0aW9uKGluZGljZXMsIHJlcGVhdFR5cGUuZW51bVZhbHVlLmlkZW50aWZpZXIsIGltYWdlc1BlclNlY29uZCk7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsICdTcGllbHQgZWluZSBBbmltYXRpb24gYWIuJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInBsYXlBbmltYXRpb25cIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiZnJvbUluZGV4XCIsIHR5cGU6IGludFByaW1pdGl2ZVR5cGUsIGRlY2xhcmF0aW9uOiBudWxsLCB1c2FnZVBvc2l0aW9uczogbnVsbCwgaXNGaW5hbDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwidG9JbmRleFwiLCB0eXBlOiBpbnRQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcInJlcGVhdFR5cGVcIiwgdHlwZTogbW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiUmVwZWF0VHlwZVwiKSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJpbWFnZXNQZXJTZWNvbmRcIiwgdHlwZTogaW50UHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcblxyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBmcm9tSW5kZXg6IG51bWJlciA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgdG9JbmRleDogbnVtYmVyID0gcGFyYW1ldGVyc1syXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCByZXBlYXRUeXBlOiBFbnVtUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbM10udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaW1hZ2VzUGVyU2Vjb25kOiBudW1iZXIgPSBwYXJhbWV0ZXJzWzRdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSA8U3ByaXRlSGVscGVyPm8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwicGxheUFuaW1hdGlvblwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBpbmRpY2VzOiBudW1iZXJbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0b0luZGV4IC0gZnJvbUluZGV4KSA8IDEwMDAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRlbHRhID0gTWF0aC5zaWduKHRvSW5kZXggLSBmcm9tSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBmcm9tSW5kZXg7IGkgIT0gdG9JbmRleDsgaSA9IGkgKyBkZWx0YSkgaW5kaWNlcy5wdXNoKGkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNoLnBsYXlBbmltYXRpb24oaW5kaWNlcywgcmVwZWF0VHlwZS5lbnVtVmFsdWUuaWRlbnRpZmllciwgaW1hZ2VzUGVyU2Vjb25kKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgJ1NwaWVsdCBlaW5lIEFuaW1hdGlvbiBhYi4nLCBmYWxzZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwic3RvcEFuaW1hdGlvblwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgXSksIG51bGwsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSA8U3ByaXRlSGVscGVyPm8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC5pc0Rlc3Ryb3llZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnN0b3BBbmltYXRpb24oZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnU3RvcHB0IGRpZSBnZXJhZGUgbGF1ZmVuZGUgQW5pbWF0aW9uJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInBhdXNlQW5pbWF0aW9uXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICBdKSwgbnVsbCxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2g6IFNwcml0ZUhlbHBlciA9IDxTcHJpdGVIZWxwZXI+by5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJwYXVzZUFuaW1hdGlvblwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnBhdXNlQW5pbWF0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsICdQYXVzaWVydCBkaWUgbGF1ZmVuZGUgQW5pbWF0aW9uLicsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJyZXN1bWVBbmltYXRpb25cIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgIF0pLCBudWxsLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gPFNwcml0ZUhlbHBlcj5vLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInJlc3VtZUFuaW1hdGlvblwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnJlc3VtZUFuaW1hdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnRsOkaHJ0IG1pdCBlaW5lciBwYXVzaWVydGVuIEFuaW1hdGlvbiB3aWVkZXIgZm9ydC4nLCBmYWxzZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwic2V0QWxwaGFcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiYWxwaGFWYWx1ZVwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICBdKSwgdm9pZFByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGFscGhhOiBudW1iZXIgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSBvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcInNldEFscGhhXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgc2guc2V0QWxwaGEoYWxwaGEpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnU2V0enQgZGllIER1cmNoc2ljaHRpZ2tlaXQuIDAuMCBiZWRldXRldCB2b2xsa29tbWVuIGR1cmNoc2ljaHRpZywgMS4wIGJlZGV1dGV0IHZvbGxrb21tZW4gdW5kdXJjaHNpY2h0aWcuJywgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImNvcHlcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgIF0pLCB0aGlzLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJjb3B5XCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNoLmdldENvcHkoPEtsYXNzPm8uY2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCAnRXJzdGVsbHQgZWluZSBLb3BpZSBkZXMgU3ByaXRlLU9iamVrdHMgdW5kIGdpdCBzaWUgenVyw7xjay4nLCBmYWxzZSkpO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImdldFdpZHRoXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICBdKSwgZG91YmxlUHJpbWl0aXZlVHlwZSxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgc2g6IFNwcml0ZUhlbHBlciA9IG8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwiZ2V0V2lkdGhcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2guZ2V0V2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgXCJHaWJ0IGRpZSBCcmVpdGUgenVyw7xjay5cIiwgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImdldEhlaWdodFwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgXSksIGRvdWJsZVByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSBvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcImdldEhlaWdodFwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBzaC5nZXRIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgXCJHaWJ0IGRpZSBIw7ZoZSB6dXLDvGNrLlwiLCBmYWxzZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwibWFrZVRpbGluZ1wiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJ3aWR0aFwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImhlaWdodFwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfVxyXG4gICAgICAgIF0pLCB2b2lkUHJpbWl0aXZlVHlwZSxcclxuICAgICAgICAgICAgKHBhcmFtZXRlcnMpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbzogUnVudGltZU9iamVjdCA9IHBhcmFtZXRlcnNbMF0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgd2lkdGg6IG51bWJlciA9IHBhcmFtZXRlcnNbMV0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBTcHJpdGVIZWxwZXIgPSBvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2gudGVzdGRlc3Ryb3llZChcIm1ha2VUaWxpbmdcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5tYWtlVGlsaW5nKHdpZHRoLCBoZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCBcIkbDvGd0IGRhcyBpZGVudGlzY2hlIEJpbGQgbmFjaCByZWNodHMgdW5kIHVudGVuIGthY2hlbGFydGlnICgndGlsZSchKSBzbyBvZnQgaGluenUsIGJpcyBkaWUgYW5nZWdlYmVuZSBCcmVpdGUgZXJyZWljaHQgaXN0LiBcXG5USVBQOiBNaXQgZGVyIE1ldGhvZGUgZ2V0VGlsZUltYWdlKCkgZXJow6RsdCBtYW4gZWluIFRpbGUtT2JqZWt0LCBkZXNzZW4gTWV0aG9kZW4gbW92ZSwgc2NhbGUsIG1pcnJvclggdW5kIG1pcnJvclkgc2ljaCBnbGVpY2h6ZWl0aWcgYXVmIGplZGUgZWluemVsbmUgS2FjaGVsIGF1c3dpcmtlbi5cIiwgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcImdldFRpbGVJbWFnZVwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgXSksIDxLbGFzcz5tb2R1bGUudHlwZVN0b3JlLmdldFR5cGUoXCJUaWxlXCIpLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogU3ByaXRlSGVscGVyID0gby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJnZXRUaWxlSW1hZ2VcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZighc2guaXNUaWxlU3ByaXRlKXtcclxuICAgICAgICAgICAgICAgICAgICBzaC53b3JsZEhlbHBlci5pbnRlcnByZXRlci50aHJvd0V4Y2VwdGlvbihcIkRhcyBTcHJpdGUgaGF0IGtlaW4gVGlsZUltYWdlLiBTaWUgbcO8c3NlbiBlcyB6dWVyc3QgbWl0IGRlciBNZXRob2RlIG1ha2VUaWxpbmcgaW4gZWluIEthY2hlbC1TcHJpdGUgdW13YW5kZWxuLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgcmV0OiBSdW50aW1lT2JqZWN0ID0gbmV3IFJ1bnRpbWVPYmplY3QoPEtsYXNzPm1vZHVsZS50eXBlU3RvcmUuZ2V0VHlwZShcIlRpbGVcIikpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldC5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl0gPSBuZXcgVGlsZUhlbHBlcihzaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgXCJOYWNoZGVtIGRhcyBTcHJpdGUgbWl0dGVscyBkZXIgTWV0aG9kZSAnbWFrZVRpbGluZycgenVtIFRpbGVTcHJpdGUgZ2VtYWNodCB3dXJkZSwga2FubiB3aXJrZW4gZGllIE1ldGhvZGVuIG1vdmUsIHNjYWxlIHVuZCByb3RhdGUgaW1tZXIgYXVmIGRlbiBnYW56ZW4gZ2VrYWNoZWx0ZW4gQmVyZWljaC4gV2lsbCBtYW4gZGFzIHZlcmZpZWxmYWNodGUgQmlsZCDDpG5kZXJuLCBzbyBiZWtvbW10IG1hbiDDvGJlciBkaWVzZSBNZXRob2RlIGRhcyBTcHJpdGUtT2JqZWt0LCBkYXMgZGllc2VtIEJpbGQgZW50c3ByaWNodC4gUnVmdCBtYW4gZsO8ciBkaWVzZXMgT2JqZWt0IGRpZSBNZXRob2RlbiBtb3ZlLCByb3RhdGUgb2RlciBzY2FsZSBhdWYsIHNvIHdpcmtlbiBzaWUgYXVmIGplZGUgZGVyIGVpbnplbG5lbiBLYWNoZWxuLlwiLCBmYWxzZSkpO1xyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTcHJpdGVIZWxwZXIgZXh0ZW5kcyBTaGFwZUhlbHBlciB7XHJcblxyXG4gICAgYW5pbWF0aW9uSW5kaWNlczogbnVtYmVyW10gPSBbXTtcclxuICAgIGFuaW1hdGlvblJ1bnM6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGltYWdlc1Blck1pbGxpc2Vjb25kOiBudW1iZXIgPSAxO1xyXG4gICAgYW5pbWF0aW9uVGltZTogbnVtYmVyID0gMDtcclxuICAgIGFuaW1hdGlvblBhdXNlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIHJlcGVhdFR5cGUgPSBcIm9uY2VcIjtcclxuICAgIHRleHR1cmVOYW1lOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICAgIGlzVGlsZVNwcml0ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB4OiBudW1iZXIsIHB1YmxpYyB5OiBudW1iZXIsIHB1YmxpYyBuYW1lOiBzdHJpbmcsIHB1YmxpYyBpbmRleDogbnVtYmVyLFxyXG4gICAgICAgIGludGVycHJldGVyOiBJbnRlcnByZXRlciwgcnVudGltZU9iamVjdDogUnVudGltZU9iamVjdCwgY29weUZyb21PdGhlclNoYXBlPzogU2hhcGVIZWxwZXIsXHJcbiAgICAgICAgcHVibGljIHNjYWxlTW9kZTogc3RyaW5nID0gXCJuZWFyZXN0X25laWdoYm91clwiKSB7XHJcbiAgICAgICAgc3VwZXIoaW50ZXJwcmV0ZXIsIHJ1bnRpbWVPYmplY3QpO1xyXG5cclxuICAgICAgICBpZiAoY29weUZyb21PdGhlclNoYXBlID09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRUZXh0dXJlKG51bGwsIGluZGV4KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNvcHlCaXRtYXBGcm9tU2hhcGUoY29weUZyb21PdGhlclNoYXBlKTtcclxuICAgICAgICAgICAgbGV0IGJvdW5kcyA9IGNvcHlGcm9tT3RoZXJTaGFwZS5kaXNwbGF5T2JqZWN0LmdldEJvdW5kcygpO1xyXG4gICAgICAgICAgICB0aGlzLnggPSBib3VuZHMubGVmdCArIGJvdW5kcy53aWR0aCAvIDI7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IGJvdW5kcy50b3AgKyBib3VuZHMuaGVpZ2h0IC8gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzcHJpdGUgPSA8UElYSS5TcHJpdGU+dGhpcy5kaXNwbGF5T2JqZWN0O1xyXG5cclxuICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3QubG9jYWxUcmFuc2Zvcm0udHJhbnNsYXRlKHRoaXMueCAtIHNwcml0ZS53aWR0aCAvIDIsIHRoaXMueSAtIHNwcml0ZS5oZWlnaHQgLyAyKTtcclxuICAgICAgICAvL0B0cy1pZ25vcmVcclxuICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3QudHJhbnNmb3JtLm9uQ2hhbmdlKCk7XHJcblxyXG4gICAgICAgIHRoaXMud29ybGRIZWxwZXIuc3RhZ2UuYWRkQ2hpbGQoc3ByaXRlKTtcclxuXHJcbiAgICAgICAgdGhpcy5jZW50ZXJYSW5pdGlhbCA9IHNwcml0ZS53aWR0aCAvIDI7XHJcbiAgICAgICAgdGhpcy5jZW50ZXJZSW5pdGlhbCA9IHNwcml0ZS5oZWlnaHQgLyAyO1xyXG5cclxuICAgICAgICB0aGlzLmFkZFRvRGVmYXVsdEdyb3VwQW5kU2V0RGVmYXVsdFZpc2liaWxpdHkoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbWFrZVRpbGluZyh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgICAgIHdpZHRoIC89IHRoaXMuc2NhbGVGYWN0b3I7XHJcbiAgICAgICAgaGVpZ2h0IC89IHRoaXMuc2NhbGVGYWN0b3I7XHJcbiAgICAgICAgbGV0IHNwcml0ZTogUElYSS5TcHJpdGUgPSA8UElYSS5TcHJpdGU+dGhpcy5kaXNwbGF5T2JqZWN0O1xyXG4gICAgICAgIGxldCB0aWxlU3ByaXRlID0gbmV3IFBJWEkuVGlsaW5nU3ByaXRlKHNwcml0ZS50ZXh0dXJlLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICBzcHJpdGUudGV4dHVyZS5iYXNlVGV4dHVyZS5taXBtYXAgPSBQSVhJLk1JUE1BUF9NT0RFUy5PRkY7XHJcbiAgICAgICAgdGlsZVNwcml0ZS5zZXRQYXJlbnQoc3ByaXRlLnBhcmVudCk7XHJcbiAgICAgICAgdGlsZVNwcml0ZS50cmFuc2Zvcm0ubG9jYWxUcmFuc2Zvcm0uY29weUZyb20oc3ByaXRlLnRyYW5zZm9ybS5sb2NhbFRyYW5zZm9ybSk7XHJcbiAgICAgICAgLy9AdHMtaWdub3JlXHJcbiAgICAgICAgdGlsZVNwcml0ZS50cmFuc2Zvcm0ub25DaGFuZ2UoKTtcclxuICAgICAgICB0aWxlU3ByaXRlLnVwZGF0ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgIC8vIHRpbGVTcHJpdGUuY2xhbXBNYXJnaW4gPSAtMC41O1xyXG4gICAgICAgIHRoaXMuZGlzcGxheU9iamVjdCA9IHRpbGVTcHJpdGU7XHJcbiAgICAgICAgdGhpcy5jZW50ZXJYSW5pdGlhbCArPSAtc3ByaXRlLndpZHRoIC8gMiArIHdpZHRoIC8gMjtcclxuICAgICAgICB0aGlzLmNlbnRlcllJbml0aWFsICs9IC1zcHJpdGUuaGVpZ2h0IC8gMiArIGhlaWdodCAvIDI7XHJcbiAgICAgICAgbGV0IGxlZnQgPSB0aGlzLmNlbnRlclhJbml0aWFsIC0gd2lkdGggLyAyO1xyXG4gICAgICAgIGxldCB0b3AgPSB0aGlzLmNlbnRlcllJbml0aWFsIC0gaGVpZ2h0IC8gMjtcclxuICAgICAgICBsZXQgcmlnaHQgPSBsZWZ0ICsgd2lkdGg7XHJcbiAgICAgICAgbGV0IGJvdHRvbSA9IHRvcCArIGhlaWdodDtcclxuICAgICAgICB0aGlzLmhpdFBvbHlnb25Jbml0aWFsID0gW1xyXG4gICAgICAgICAgICB7IHg6IGxlZnQsIHk6IHRvcCB9LCB7IHg6IHJpZ2h0LCB5OiB0b3AgfSwgeyB4OiByaWdodCwgeTogYm90dG9tIH0sIHsgeDogbGVmdCwgeTogYm90dG9tIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIHRoaXMuc2V0SGl0UG9seWdvbkRpcnR5KHRydWUpO1xyXG4gICAgICAgIHNwcml0ZS5kZXN0cm95KCk7XHJcbiAgICAgICAgdGhpcy5pc1RpbGVTcHJpdGUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFRpbGVPZmZzZXQoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1RpbGVTcHJpdGUpIHtcclxuICAgICAgICAgICAgbGV0IHRpbGVTcHJpdGU6IFBJWEkuVGlsaW5nU3ByaXRlID0gPFBJWEkuVGlsaW5nU3ByaXRlPnRoaXMuZGlzcGxheU9iamVjdDtcclxuICAgICAgICAgICAgdGlsZVNwcml0ZS50aWxlUG9zaXRpb24uc2V0KHgsIHkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgY29weUJpdG1hcEZyb21TaGFwZShjb3B5RnJvbU90aGVyU2hhcGU6IFNoYXBlSGVscGVyKSB7XHJcblxyXG4gICAgICAgIGxldCBib3VuZHMgPSBjb3B5RnJvbU90aGVyU2hhcGUuZGlzcGxheU9iamVjdC5nZXRCb3VuZHMoKTtcclxuXHJcbiAgICAgICAgbGV0IHdpZHRoID0gYm91bmRzLndpZHRoO1xyXG4gICAgICAgIGxldCBoZWlnaHQgPSBib3VuZHMuaGVpZ2h0O1xyXG5cclxuICAgICAgICBjb25zdCBicnQgPSBuZXcgUElYSS5CYXNlUmVuZGVyVGV4dHVyZShcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc2NhbGVNb2RlOiB0aGlzLnNjYWxlTW9kZSA9PSBcIm5lYXJlc3RfbmVpZ2hib3VyXCIgPyBQSVhJLlNDQUxFX01PREVTLk5FQVJFU1QgOiBQSVhJLlNDQUxFX01PREVTLkxJTkVBUixcclxuICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIGxldCBydDogUElYSS5SZW5kZXJUZXh0dXJlID0gbmV3IFBJWEkuUmVuZGVyVGV4dHVyZShicnQpO1xyXG5cclxuICAgICAgICBsZXQgZG9iID0gY29weUZyb21PdGhlclNoYXBlLmRpc3BsYXlPYmplY3Q7XHJcbiAgICAgICAgdGhpcy53b3JsZEhlbHBlci5hcHAucmVuZGVyZXIucmVuZGVyKGRvYiwge1xyXG4gICAgICAgICAgICByZW5kZXJUZXh0dXJlOiBydCxcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBuZXcgUElYSS5NYXRyaXgoKS50cmFuc2xhdGUoLWJvdW5kcy5sZWZ0LCAtYm91bmRzLnRvcClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IHBvaW50czogY29udmV4aHVsbC5Qb2ludFtdID0gW107XHJcbiAgICAgICAgcG9pbnRzID0gdGhpcy5leHRyYWN0UG9pbnRzKGNvcHlGcm9tT3RoZXJTaGFwZSwgcG9pbnRzKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgcCBvZiBwb2ludHMpIHtcclxuICAgICAgICAgICAgcC54IC09IGJvdW5kcy5sZWZ0O1xyXG4gICAgICAgICAgICBwLnkgLT0gYm91bmRzLnRvcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaGl0UG9seWdvbkluaXRpYWwgPSBwb2ludHM7XHJcbiAgICAgICAgdGhpcy5oaXRQb2x5Z29uSW5pdGlhbCA9IGNvbnZleGh1bGwubWFrZUh1bGwocG9pbnRzKTtcclxuXHJcbiAgICAgICAgdGhpcy5oaXRQb2x5Z29uRGlydHkgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3QgPSBuZXcgUElYSS5TcHJpdGUocnQpO1xyXG5cclxuICAgICAgICBjb3B5RnJvbU90aGVyU2hhcGUuc2V0SGl0UG9seWdvbkRpcnR5KHRydWUpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBleHRyYWN0UG9pbnRzKHNoYXBlSGVscGVyOiBTaGFwZUhlbHBlciwgcG9pbnRzOiBjb252ZXhodWxsLlBvaW50W10pOiBjb252ZXhodWxsLlBvaW50W10ge1xyXG4gICAgICAgIGlmIChzaGFwZUhlbHBlciBpbnN0YW5jZW9mIEdyb3VwSGVscGVyKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHNoIG9mIHNoYXBlSGVscGVyLnNoYXBlcykge1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzID0gdGhpcy5leHRyYWN0UG9pbnRzKHNoLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXSwgcG9pbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcG9pbnRzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUhlbHBlci5oaXRQb2x5Z29uRGlydHkpIHNoYXBlSGVscGVyLnRyYW5zZm9ybUhpdFBvbHlnb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIHBvaW50cy5jb25jYXQoc2hhcGVIZWxwZXIuaGl0UG9seWdvblRyYW5zZm9ybWVkLm1hcChmdW5jdGlvbiAocHVua3QpIHsgcmV0dXJuIHsgeDogcHVua3QueCwgeTogcHVua3QueSB9IH0pKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldFdpZHRoKCk6IG51bWJlciB7XHJcbiAgICAgICAgbGV0IHNwcml0ZSA9IDxQSVhJLlNwcml0ZT50aGlzLmRpc3BsYXlPYmplY3Q7XHJcbiAgICAgICAgcmV0dXJuIHNwcml0ZS53aWR0aCAqIHRoaXMuc2NhbGVGYWN0b3I7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SGVpZ2h0KCk6IG51bWJlciB7XHJcbiAgICAgICAgbGV0IHNwcml0ZSA9IDxQSVhJLlNwcml0ZT50aGlzLmRpc3BsYXlPYmplY3Q7XHJcbiAgICAgICAgcmV0dXJuIHNwcml0ZS5oZWlnaHQgKiB0aGlzLnNjYWxlRmFjdG9yO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENvcHkoa2xhc3M6IEtsYXNzKTogUnVudGltZU9iamVjdCB7XHJcblxyXG4gICAgICAgIGxldCBybzogUnVudGltZU9iamVjdCA9IG5ldyBSdW50aW1lT2JqZWN0KGtsYXNzKTtcclxuICAgICAgICBsZXQgcmg6IFNwcml0ZUhlbHBlciA9IG5ldyBTcHJpdGVIZWxwZXIodGhpcy54LCB0aGlzLnksIHRoaXMubmFtZSwgdGhpcy5pbmRleCwgdGhpcy53b3JsZEhlbHBlci5pbnRlcnByZXRlciwgcm8pO1xyXG4gICAgICAgIHJvLmludHJpbnNpY0RhdGFbXCJBY3RvclwiXSA9IHJoO1xyXG5cclxuICAgICAgICByaC5jb3B5RnJvbSh0aGlzKTtcclxuICAgICAgICByaC5yZW5kZXIoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJvO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzZXRBbHBoYShhbHBoYTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5T2JqZWN0LmFscGhhID0gYWxwaGE7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VGV4dHVyZShuYW1lPzogc3RyaW5nLCBpbmRleD86IG51bWJlcikge1xyXG5cclxuICAgICAgICBpZiAobmFtZSA9PSB0aGlzLm5hbWUgJiYgaW5kZXggPT0gdGhpcy5pbmRleCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAobmFtZSA9PSBudWxsKSBuYW1lID0gdGhpcy5uYW1lO1xyXG4gICAgICAgIGlmIChpbmRleCA9PSBudWxsKSBpbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xyXG5cclxuICAgICAgICB0aGlzLnRleHR1cmVOYW1lID0gbmFtZTtcclxuXHJcbiAgICAgICAgLy8gbGV0IHByZWZpeCA9IFwiXCI7XHJcbiAgICAgICAgLy8gLy9AdHMtaWdub3JlXHJcbiAgICAgICAgLy8gaWYgKHdpbmRvdy5qYXZhT25saW5lRGlyICE9IG51bGwpIHtcclxuICAgICAgICAvLyAgICAgLy9AdHMtaWdub3JlXHJcbiAgICAgICAgLy8gICAgIHByZWZpeCA9IHdpbmRvdy5qYXZhT25saW5lRGlyO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy8gbGV0IHNoZWV0ID0gUElYSS5Mb2FkZXIuc2hhcmVkLnJlc291cmNlc1twcmVmaXggKyBcImFzc2V0cy9ncmFwaGljcy9zcHJpdGVzaGVldC5qc29uXCJdLnNwcml0ZXNoZWV0O1xyXG4gICAgICAgIGxldCBzaGVldCA9IFBJWEkuTG9hZGVyLnNoYXJlZC5yZXNvdXJjZXNbXCJzcHJpdGVzaGVldFwiXS5zcHJpdGVzaGVldDtcclxuICAgICAgICBsZXQgbmFtZVdpdGhJbmRleCA9IG5hbWUgKyBcIiNcIiArIGluZGV4O1xyXG4gICAgICAgIGxldCB0ZXh0dXJlID0gc2hlZXQudGV4dHVyZXNbbmFtZVdpdGhJbmRleF07XHJcblxyXG4gICAgICAgIGlmICh0ZXh0dXJlICE9IG51bGwpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjYWxlTW9kZSA9PSBcImxpbmVhclwiKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSB0aGlzLndvcmxkSGVscGVyLnNjYWxlZFRleHR1cmVzW25hbWVXaXRoSW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHRleHR1cmUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgZHluYW1pY1RleHR1cmUxID0gUElYSS5SZW5kZXJUZXh0dXJlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzcHJpdGUud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogc3ByaXRlLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVNb2RlOiBQSVhJLlNDQUxFX01PREVTLkxJTkVBUlxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndvcmxkSGVscGVyLmFwcC5yZW5kZXJlci5yZW5kZXIoc3ByaXRlLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlclRleHR1cmU6IGR5bmFtaWNUZXh0dXJlMVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMud29ybGRIZWxwZXIuc2NhbGVkVGV4dHVyZXNbbmFtZVdpdGhJbmRleF0gPSBkeW5hbWljVGV4dHVyZTE7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IGR5bmFtaWNUZXh0dXJlMTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0ZXh0dXJlID0gdDtcclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0dXJlID09IG51bGwpIHRleHR1cmUgPSBzaGVldC50ZXh0dXJlc1tuYW1lV2l0aEluZGV4XTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBsZXQgdCA9IHRoaXMud29ybGRIZWxwZXIuc2NhbGVkVGV4dHVyZXNbbmFtZVdpdGhJbmRleF1bdGhpcy5zY2FsZU9uVGV4dHVyZUdlbmVyYXRpb25dO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYoIHQgIT0gbnVsbCl7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGV4dHVyZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGxldCBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGxldCBkeW5hbWljVGV4dHVyZTEgPSBQSVhJLlJlbmRlclRleHR1cmUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgd2lkdGg6IHNwcml0ZS53aWR0aCxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgaGVpZ2h0OiBzcHJpdGUuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBzY2FsZU1vZGU6IFBJWEkuU0NBTEVfTU9ERVMuTkVBUkVTVFxyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLndvcmxkSGVscGVyLmFwcC5yZW5kZXJlci5yZW5kZXIoc3ByaXRlLCBkeW5hbWljVGV4dHVyZTEsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUoZHluYW1pY1RleHR1cmUxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgbGV0IGR5bmFtaWNUZXh0dXJlMiA9IFBJWEkuUmVuZGVyVGV4dHVyZS5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB3aWR0aDogc3ByaXRlLndpZHRoICogdGhpcy5zY2FsZU9uVGV4dHVyZUdlbmVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGhlaWdodDogc3ByaXRlLmhlaWdodCAqIHRoaXMuc2NhbGVPblRleHR1cmVHZW5lcmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBzY2FsZU1vZGU6IFBJWEkuU0NBTEVfTU9ERVMuTElORUFSXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gICAgIGxldCBtID0gbmV3IFBJWEkuTWF0cml4KCk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgbS5zY2FsZSh0aGlzLnNjYWxlT25UZXh0dXJlR2VuZXJhdGlvbiwgdGhpcy5zY2FsZU9uVGV4dHVyZUdlbmVyYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLndvcmxkSGVscGVyLmFwcC5yZW5kZXJlci5yZW5kZXIoc3ByaXRlLCBkeW5hbWljVGV4dHVyZTIsIHRydWUsXHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIG0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICB0ZXh0dXJlID0gZHluYW1pY1RleHR1cmUyO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLndvcmxkSGVscGVyLnNjYWxlZFRleHR1cmVzW25hbWVXaXRoSW5kZXhdW3RoaXMuc2NhbGVPblRleHR1cmVHZW5lcmF0aW9uXSA9IHRleHR1cmU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBzcHJpdGU6IFBJWEkuU3ByaXRlID0gPFBJWEkuU3ByaXRlPnRoaXMuZGlzcGxheU9iamVjdDtcclxuICAgICAgICAgICAgaWYgKHNwcml0ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUgPSBuZXcgUElYSS5TcHJpdGUodGV4dHVyZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlPYmplY3QgPSBzcHJpdGU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUudGV4dHVyZSA9IHRleHR1cmU7IC8vIHNoZWV0LnRleHR1cmVzW25hbWVXaXRoSW5kZXhdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmhpdFBvbHlnb25Jbml0aWFsID0gSGl0UG9seWdvblN0b3JlLmdldFBvbHlnb25Gb3JUZXh0dXJlKG5hbWUsIGluZGV4LCB0aGlzLCBuZXcgUElYSS5TcHJpdGUoc2hlZXQudGV4dHVyZXNbbmFtZVdpdGhJbmRleF0pKTtcclxuICAgICAgICAgICAgdGhpcy5oaXRQb2x5Z29uRGlydHkgPSB0cnVlO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kaXNwbGF5T2JqZWN0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheU9iamVjdCA9IG5ldyBQSVhJLlNwcml0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCk6IHZvaWQge1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgcGxheUFuaW1hdGlvbihpbmRleEFycmF5OiBudW1iZXJbXSwgcmVwZWF0VHlwZTogc3RyaW5nLCBpbWFnZXNQZXJTZWNvbmQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbihmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5hbmltYXRpb25JbmRpY2VzID0gaW5kZXhBcnJheTtcclxuICAgICAgICB0aGlzLnJlcGVhdFR5cGUgPSByZXBlYXRUeXBlO1xyXG4gICAgICAgIHRoaXMuaW1hZ2VzUGVyTWlsbGlzZWNvbmQgPSBpbWFnZXNQZXJTZWNvbmQgLyAxMDAwO1xyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uVGltZSA9IDA7XHJcbiAgICAgICAgdGhpcy5hbmltYXRpb25SdW5zID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLndvcmxkSGVscGVyLnNwcml0ZUFuaW1hdGlvbnMucHVzaCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBzdG9wQW5pbWF0aW9uKHNldEludmlzaWJsZTogYm9vbGVhbikge1xyXG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGlvblJ1bnMpIHtcclxuICAgICAgICAgICAgbGV0IHNwcml0ZUhlbHBlckxpc3QgPSB0aGlzLndvcmxkSGVscGVyLnNwcml0ZUFuaW1hdGlvbnM7XHJcbiAgICAgICAgICAgIGxldCBpID0gc3ByaXRlSGVscGVyTGlzdC5pbmRleE9mKHRoaXMpO1xyXG4gICAgICAgICAgICBpZiAoaSA+PSAwKSBzcHJpdGVIZWxwZXJMaXN0LnNwbGljZShpLCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hbmltYXRpb25SdW5zID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHNldEludmlzaWJsZSkgdGhpcy5zZXRWaXNpYmxlKGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICBwYXVzZUFuaW1hdGlvbigpIHtcclxuICAgICAgICB0aGlzLmFuaW1hdGlvblBhdXNlZCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzdW1lQW5pbWF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uUGF1c2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdGljayhkZWx0YVRpbWU6IG51bWJlcikge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5hbmltYXRpb25QYXVzZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IGltYWdlOiBudW1iZXI7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJlcGVhdFR5cGUgPT0gXCJiYWNrQW5kRm9ydGhcIikge1xyXG4gICAgICAgICAgICBsZXQgcGVyaW9kMiA9IHRoaXMuYW5pbWF0aW9uSW5kaWNlcy5sZW5ndGggKiAyIC8gdGhpcy5pbWFnZXNQZXJNaWxsaXNlY29uZDtcclxuICAgICAgICAgICAgbGV0IG51bWJlck9mUGVyaW9kc0RvbmUgPSBNYXRoLnRydW5jKHRoaXMuYW5pbWF0aW9uVGltZSAvIHBlcmlvZDIpO1xyXG4gICAgICAgICAgICBsZXQgdGltZUludG9QZXJpb2QgPSB0aGlzLmFuaW1hdGlvblRpbWUgLSBudW1iZXJPZlBlcmlvZHNEb25lICogcGVyaW9kMjtcclxuICAgICAgICAgICAgaW1hZ2UgPSB0aGlzLmltYWdlc1Blck1pbGxpc2Vjb25kICogdGltZUludG9QZXJpb2Q7XHJcbiAgICAgICAgICAgIGlmIChpbWFnZSA+PSB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpbWFnZSA9IE1hdGgubWF4KDIgKiB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoIC0gMC4xIC0gaW1hZ2UsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGltYWdlID0gTWF0aC50cnVuYyhpbWFnZSk7XHJcbiAgICAgICAgfSBlbHNlXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlcGVhdFR5cGUgPT0gXCJsb29wXCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBwZXJpb2QgPSB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoIC8gdGhpcy5pbWFnZXNQZXJNaWxsaXNlY29uZDtcclxuICAgICAgICAgICAgICAgIGxldCBudW1iZXJPZlBlcmlvZHNEb25lID0gTWF0aC50cnVuYyh0aGlzLmFuaW1hdGlvblRpbWUgLyBwZXJpb2QpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbWVJbnRvUGVyaW9kID0gdGhpcy5hbmltYXRpb25UaW1lIC0gbnVtYmVyT2ZQZXJpb2RzRG9uZSAqIHBlcmlvZDtcclxuICAgICAgICAgICAgICAgIGltYWdlID0gdGhpcy5pbWFnZXNQZXJNaWxsaXNlY29uZCAqIHRpbWVJbnRvUGVyaW9kO1xyXG4gICAgICAgICAgICAgICAgaW1hZ2UgPSBNYXRoLnRydW5jKGltYWdlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGltYWdlID0gTWF0aC50cnVuYyh0aGlzLmltYWdlc1Blck1pbGxpc2Vjb25kICogdGhpcy5hbmltYXRpb25UaW1lKTtcclxuICAgICAgICAgICAgICAgIGlmIChpbWFnZSA+PSB0aGlzLmFuaW1hdGlvbkluZGljZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFuaW1hdGlvblRpbWUgKz0gZGVsdGFUaW1lO1xyXG5cclxuICAgICAgICB0aGlzLnNldFRleHR1cmUobnVsbCwgdGhpcy5hbmltYXRpb25JbmRpY2VzW2ltYWdlXSk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGlsZUNsYXNzIGV4dGVuZHMgS2xhc3Mge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG1vZHVsZTogTW9kdWxlKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKFwiVGlsZVwiLCBtb2R1bGUsIFwiRWluZSBLYWNoZWwgaW4gZWluZW0gU3ByaXRlLCBkYXMgbWl0aGlsZmUgZGVyIE1ldGhvZGUgbWFrZVRpbGluZyB6dSBlaW5lciBLYWNoZWxmbMOkY2hlIGdlbWFjaHQgd3VyZGUuXCIpO1xyXG5cclxuICAgICAgICB0aGlzLnNldEJhc2VDbGFzcyg8S2xhc3M+bW9kdWxlLnR5cGVTdG9yZS5nZXRUeXBlKFwiT2JqZWN0XCIpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcIm1vdmVcIiwgbmV3IFBhcmFtZXRlcmxpc3QoW1xyXG4gICAgICAgICAgICB7IGlkZW50aWZpZXI6IFwiZHhcIiwgdHlwZTogZG91YmxlUHJpbWl0aXZlVHlwZSwgZGVjbGFyYXRpb246IG51bGwsIHVzYWdlUG9zaXRpb25zOiBudWxsLCBpc0ZpbmFsOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIHsgaWRlbnRpZmllcjogXCJkeVwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICBdKSwgdm9pZFByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGR4OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzFdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGR5OiBudW1iZXIgPSBwYXJhbWV0ZXJzWzJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBUaWxlSGVscGVyID0gby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJtb3ZlXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgc2gubW92ZShkeCwgZHkpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCBcIlZlcnNjaGllYnQgZGFzIEdyYWZpa29iamVrdCB1bSBkeCBQaXhlbCBuYWNoIHJlY2h0cyB1bmQgdW0gZHkgUGl4ZWwgbmFjaCB1bnRlbi5cIiwgZmFsc2UpKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRNZXRob2QobmV3IE1ldGhvZChcInNjYWxlXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICAgICAgeyBpZGVudGlmaWVyOiBcImZhY3RvclwiLCB0eXBlOiBkb3VibGVQcmltaXRpdmVUeXBlLCBkZWNsYXJhdGlvbjogbnVsbCwgdXNhZ2VQb3NpdGlvbnM6IG51bGwsIGlzRmluYWw6IHRydWUgfSxcclxuICAgICAgICBdKSwgdm9pZFByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGZhY3RvcjogbnVtYmVyID0gcGFyYW1ldGVyc1sxXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogVGlsZUhlbHBlciA9IG8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwic2NhbGVcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBzaC5zY2FsZShmYWN0b3IsIGZhY3Rvcik7XHJcblxyXG4gICAgICAgICAgICB9LCBmYWxzZSwgZmFsc2UsIFwiU3RyZWNrdCBkYXMgR3JhZmlrb2JqZWt0IHVtIGRlbiBhbmdlZ2ViZW5lbiBGYWt0b3IuIERhcyBaZW50cnVtIGRlciBTdHJlY2t1bmcgaXN0IGRlciAnTWl0dGVscHVua3QnIGRlcyBPYmpla3RzLlwiLCBmYWxzZSkpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZE1ldGhvZChuZXcgTWV0aG9kKFwibWlycm9yWFwiLCBuZXcgUGFyYW1ldGVybGlzdChbXHJcbiAgICAgICAgXSksIHZvaWRQcmltaXRpdmVUeXBlLFxyXG4gICAgICAgICAgICAocGFyYW1ldGVycykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBvOiBSdW50aW1lT2JqZWN0ID0gcGFyYW1ldGVyc1swXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGxldCBzaDogVGlsZUhlbHBlciA9IG8uaW50cmluc2ljRGF0YVtcIkFjdG9yXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaC50ZXN0ZGVzdHJveWVkKFwibWlycm9yWFwiKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoLnNjYWxlKC0xLCAxKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZhbHNlLCBmYWxzZSwgXCJTcGllZ2VsdCBkYXMgT2JqZWt0IGluIFgtUmljaHR1bmcuXCIsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkTWV0aG9kKG5ldyBNZXRob2QoXCJtaXJyb3JZXCIsIG5ldyBQYXJhbWV0ZXJsaXN0KFtcclxuICAgICAgICBdKSwgdm9pZFByaW1pdGl2ZVR5cGUsXHJcbiAgICAgICAgICAgIChwYXJhbWV0ZXJzKSA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG86IFJ1bnRpbWVPYmplY3QgPSBwYXJhbWV0ZXJzWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoOiBUaWxlSGVscGVyID0gby5pbnRyaW5zaWNEYXRhW1wiQWN0b3JcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNoLnRlc3RkZXN0cm95ZWQoXCJtaXJyb3JYXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgc2guc2NhbGUoMSwgLTEpO1xyXG5cclxuICAgICAgICAgICAgfSwgZmFsc2UsIGZhbHNlLCBcIlNwaWVnZWx0IGRhcyBPYmpla3QgaW4gWS1SaWNodHVuZy5cIiwgZmFsc2UpKTtcclxuXHJcblxyXG5cclxuXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgVGlsZUhlbHBlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgc3ByaXRlSGVscGVyOiBTcHJpdGVIZWxwZXIpIHtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlKGR4OiBudW1iZXIsIGR5OiBudW1iZXIpe1xyXG4gICAgICAgIGxldCB0aWxlU3ByaXRlOiBQSVhJLlRpbGluZ1Nwcml0ZSA9IDxQSVhJLlRpbGluZ1Nwcml0ZT50aGlzLnNwcml0ZUhlbHBlci5kaXNwbGF5T2JqZWN0O1xyXG4gICAgICAgIHRpbGVTcHJpdGUudGlsZVBvc2l0aW9uLnggKz0gZHg7XHJcbiAgICAgICAgdGlsZVNwcml0ZS50aWxlUG9zaXRpb24ueSArPSBkeTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgc2NhbGUoZng6IG51bWJlciwgZnk6IG51bWJlcil7XHJcbiAgICAgICAgbGV0IHRpbGVTcHJpdGU6IFBJWEkuVGlsaW5nU3ByaXRlID0gPFBJWEkuVGlsaW5nU3ByaXRlPnRoaXMuc3ByaXRlSGVscGVyLmRpc3BsYXlPYmplY3Q7XHJcbiAgICAgICAgdGlsZVNwcml0ZS50aWxlU2NhbGUueCAqPSBmeDtcclxuICAgICAgICB0aWxlU3ByaXRlLnRpbGVTY2FsZS55ICo9IGZ5O1xyXG4gICAgfVxyXG5cclxuICAgIHRlc3RkZXN0cm95ZWQobWV0aG9kOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zcHJpdGVIZWxwZXIudGVzdGRlc3Ryb3llZChtZXRob2QpO1xyXG4gICAgfVxyXG5cclxuXHJcbn0iXX0=